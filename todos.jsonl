{"id":"7nne6jij","title":"use frontmatter style","description":"  the todo update and create $EDITOR implementations should use a toml-frontmatter style with \"description\" as the body, rather than including \"description\" as toml multiline string\n\n  this will make it more natural to edit\n","status":"done","priority":2,"type":"task","created_at":"2026-01-19T02:45:31.668747-06:00","updated_at":"2026-01-19T17:08:40.15904-06:00","closed_at":"2026-01-19T17:08:40.15904-06:00"}
{"id":"uu7polak","title":"workspace acquire should invoke `jj workspace update-stale` before handing off","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-19T04:04:03.462636-06:00","updated_at":"2026-01-19T17:08:40.682689-06:00","closed_at":"2026-01-19T17:08:40.682689-06:00"}
{"id":"m62d7k5e","title":"workspace cleanup","description":"  problem:\n    I acquire a workspace, do some work in it, and release it\n    Then, from the default workspace, I rebase that change into trunk and continue stacking work on it\n    Then, I do something that runs a jj command in the workspace, like `incr workspace list` or `incr workspace acquire`\n    The command fails since the workspace is stale\n\n  we should be significantly more careful about this:\n    - incr should never run a jj command in an active workspace; we should remove the CHANGE output from workspace list entirely\n    - when a workspace is released, we should run `jj new root()` in it, so that it points to a change that is less likely to be immediately moved/conflicted at a distance\n    - this implies that workspace is never \"warm\" -- it's never already on your change when you acquire it\n    - so, we should remove the on-provision hook--acquire should _always_ treat its workspace as fresh, and so any necessary prep work should be in on-acquire (I don't think these semantics ever made that much sense anyway)\n    - (maybe this is already true) we should always run the hook as defined in the _target_ change--if we're coming from the todo state workspace, it won't have an on-acquire hook defined at all, and we shouldn't try to run the one from main or whatever\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-19T04:20:09.304352-06:00","updated_at":"2026-01-19T17:08:41.202214-06:00","closed_at":"2026-01-19T17:08:41.202214-06:00"}
{"id":"n7roiwjs","title":"broken columns in `incr todo list`","description":"  I would bet that the ansi id highlighting broke this\n\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-19T04:21:05.879496-06:00","updated_at":"2026-01-19T17:08:41.729225-06:00","closed_at":"2026-01-19T17:08:41.729225-06:00"}
{"id":"ii47fdwy","title":"workspace release/renew default to workspace in cwd","description":"if a workspace id isn't passed, the `incr workspace release` and `incr workspace renew` commands should default to the workspace checked-out in the current directory (if there is one)\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-19T04:34:16.575286-06:00","updated_at":"2026-01-19T17:08:42.245451-06:00","closed_at":"2026-01-19T17:08:42.245451-06:00"}
{"id":"kpm5r4gv","title":"todo delete","description":"we should support a 'todo delete', setting the tombstone stuff appropriately\n\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-19T04:37:33.174456-06:00","updated_at":"2026-01-19T17:08:42.766085-06:00","closed_at":"2026-01-19T17:08:42.766085-06:00"}
{"id":"2s7oyix6","title":"todo create/update should accept desc on stdin","description":"if I specify `--desc -`, the todo create and todo update commands should read a description from stdin\n\n\n\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-19T04:47:51.464032-06:00","updated_at":"2026-01-19T17:08:43.272889-06:00","closed_at":"2026-01-19T17:08:43.272889-06:00"}
{"id":"rsycuwb2","title":"Implement incr session subcommand","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-19T17:49:16.923934-06:00","updated_at":"2026-01-20T01:21:33.887611-06:00","deleted_at":"2026-01-20T01:21:33.887353-06:00"}
{"id":"lo2d7r6k","title":"Implement incr session subcommand","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-19T17:52:33.962961-06:00","updated_at":"2026-01-20T01:21:54.249554-06:00","closed_at":"2026-01-20T01:21:54.249554-06:00"}
{"id":"lzvpzeik","title":"add 'incr todo finish <id &>","description":"sets status to 'done'; akin to \"close\"\n\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T01:23:12.648243-06:00","updated_at":"2026-01-20T23:34:20.265367-06:00","closed_at":"2026-01-20T23:34:20.265367-06:00"}
{"id":"cpqnx2je","title":"add prompts","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-20T01:59:32.220518-06:00","updated_at":"2026-01-20T02:47:41.947353-06:00","deleted_at":"2026-01-20T02:47:41.947051-06:00"}
{"id":"iwb4lxbo","title":"logs like 'created todo' should use the highlighted-prefix code","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-20T01:59:58.918058-06:00","updated_at":"2026-01-20T23:39:51.952385-06:00","closed_at":"2026-01-20T23:39:51.952385-06:00"}
{"id":"t2fshlwj","title":"let's make the command 'ii', not 'incr', just for ergonomics","description":"","status":"done","priority":4,"type":"task","created_at":"2026-01-20T02:04:20.92524-06:00","updated_at":"2026-01-21T02:11:04.32763-06:00","closed_at":"2026-01-21T02:11:04.32763-06:00"}
{"id":"buwibs5p","title":"incr session start not changing working dir","description":"see the spec, I expect 'session start' to cd to the session's workspace's path\n\ntdd: cover this in the e2e tests, then fix it\n\n","status":"tombstone","priority":0,"type":"bug","created_at":"2026-01-20T02:06:40.389624-06:00","updated_at":"2026-01-20T02:49:24.593764-06:00","deleted_at":"2026-01-20T02:49:24.593408-06:00"}
{"id":"yebxfpij","title":"$EDITOR should open with md extension, not toml","description":"otherwise the highlighting is wrong in the prose sections\n\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-20T02:07:14.496687-06:00","updated_at":"2026-01-21T00:35:00.854465-06:00","closed_at":"2026-01-21T00:35:00.854465-06:00"}
{"id":"nbbqgluo","title":"add 'purpose' to workspaces","description":"- take a --purpose flag; should be a single-line string\n- include it in the list display\n- make existing callers/users of workspaces pass a purpose\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T02:21:33.240073-06:00","updated_at":"2026-01-21T00:45:00.84371-06:00","closed_at":"2026-01-21T00:45:00.84371-06:00"}
{"id":"cz77pgnu","title":"leaked workspace audit","description":"audit for leaked workspaces\n\nobviously an end-user can call 'acquire' and not call 'release', accumulating as many workspaces as they'd like.\n\nbut we want to make sure that whenever _we_ acquire a workspace, we eventually release it.\n\naudit for this and fix any you find, adding tests\n\n\n\n\n","status":"done","priority":0,"type":"task","created_at":"2026-01-20T02:23:07.51576-06:00","updated_at":"2026-01-20T23:23:27.915897-06:00","closed_at":"2026-01-20T23:23:27.915897-06:00"}
{"id":"outbv5eu","title":"session list should include session id","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-20T02:47:02.920652-06:00","updated_at":"2026-01-21T00:47:34.242422-06:00","closed_at":"2026-01-21T00:47:34.242422-06:00"}
{"id":"5wwf2kj3","title":"rm chdir stuff","description":"it occurs to me that we can't actually change the parent process's working\ndirectory in a useful way, so let's remove that from the specs, implementations,\nand tests where it occurs. Certainly the session package (or its cli wrapper),\nmaybe the workspace package (or wrapper) as well.\n\ninstead, 'start' should print the path, so that callers can do `pushd $(incr session start x)`\n\n\n\n","status":"done","priority":0,"type":"bug","created_at":"2026-01-20T02:51:00.112643-06:00","updated_at":"2026-01-20T03:00:48.960553-06:00","closed_at":"2026-01-20T03:00:48.960553-06:00"}
{"id":"khsoj447","title":"--rev @ isn't resolved correctly in workflow start","description":"it looks like @ is resolved _after_ we cd into the session's dir (which might have any @)\n\nwe should resolve the revset before acquiring the workspace\n","status":"done","priority":0,"type":"bug","created_at":"2026-01-20T03:08:12.015029-06:00","updated_at":"2026-01-20T22:56:13.305641-06:00","closed_at":"2026-01-20T22:56:13.305641-06:00"}
{"id":"qtsiuyoi","title":"workspace destroy should cascade to sessions (or fail)","description":"currently, destroying an active session's workspace leaves the session list in\nan invalid state where commands report \"workspace not found\"\n\nfix this\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T03:19:58.677466-06:00","updated_at":"2026-01-21T00:50:16.865872-06:00","closed_at":"2026-01-21T00:50:16.865872-06:00"}
{"id":"uadmlfmt","title":"add 'incr todo start x'","description":"sets status to in-progress\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T03:29:03.981022-06:00","updated_at":"2026-01-21T01:00:15.802347-06:00","closed_at":"2026-01-21T01:00:15.802347-06:00"}
{"id":"rmgcp6bl","title":"session todo id matching seems busted","description":"transcript:\n\n> incr todo list\nID        PRI  TYPE  STATUS       TITLE\n7nne6jij  P2   task  done         use frontmatter style\nuu7polak  P2   task  done         workspace acquire should invoke `jj workspace u...\nm62d7k5e  P2   task  done         workspace cleanup\nn7roiwjs  P2   bug   done         broken columns in `incr todo list`\nii47fdwy  P2   task  done         workspace release/renew default to workspace in...\nkpm5r4gv  P2   task  done         todo delete\n2s7oyix6  P2   task  done         todo create/update should accept desc on stdin\nlo2d7r6k  P2   task  done         Implement incr session subcommand\nlzvpzeik  P2   task  open         add 'incr todo finish <id &>\niwb4lxbo  P2   task  open         logs like 'created todo' should use the highlig...\nt2fshlwj  P2   task  open         let's make the command 'ii', not 'incr', just f...\nyebxfpij  P2   bug   open         $EDITOR should open with md extension, not toml\nnbbqgluo  P2   task  open         add 'purpose' to workspaces\ncz77pgnu  P0   task  open         leaked workspace audit\noutbv5eu  P2   task  in_progress  session list should include session id\n5wwf2kj3  P0   bug   done         rm chdir stuff\nkhsoj447  P0   bug   open         --rev flag isn't working in incr session start\nqtsiuyoi  P2   task  open         workspace destroy should cascade to sessions (o...\nuadmlfmt  P2   task  open         add 'incr todo start x'\n\n> incr session list\nTODO      STATUS  WORKSPACE  AGE        TOPIC                                   EXIT\ncz77pgnu  failed  ws-002     1m5s       leaked workspace audit                  -\ncz77pgnu  failed  ws-002     16m7s      leaked workspace audit                  -\noutbv5eu  failed  ws-002     3m14s      session list should include session id  -\noutbv5eu  failed  ws-002     35s        session list should include session id  -\noutbv5eu  active  ws-001     18h51m13s  session list should include session id  -\n\n> incr session fail outbv5eu\nError: todo not found\n\n\nlater: it appears `incr todo` commands still work here, it's broken for sessions specifically.\nis our domain model too wishy-washy here? I'm surprised these aren't just calling the same function\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T22:25:54.878382-06:00","updated_at":"2026-01-21T01:08:18.691279-06:00","closed_at":"2026-01-21T01:08:18.691279-06:00"}
{"id":"acedg3ke","title":"within a priority level, incr todo ready should prioritize bugs above tasks above features","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-20T22:54:05.577357-06:00","updated_at":"2026-01-21T01:11:07.919901-06:00","closed_at":"2026-01-21T01:11:07.919901-06:00"}
{"id":"zkfilnpt","title":"debug test duration","description":"ok      github.com/amonks/incrementum/cmd/incr  2.035s\nok      github.com/amonks/incrementum/internal/config   0.886s\nok      github.com/amonks/incrementum/internal/editor   0.469s\nok      github.com/amonks/incrementum/internal/jj       9.760s\n?       github.com/amonks/incrementum/internal/testsupport      [no test files]\n?       github.com/amonks/incrementum/internal/ui       [no test files]\nok      github.com/amonks/incrementum/session   (cached)\nok      github.com/amonks/incrementum/todo      94.470s\nok      github.com/amonks/incrementum/workspace (cached)\n\n^ todo takes 94 seconds? double-check to see if we're doing something stupid, like recompliing for each test or something\n\nonly optimize here, don't remove/modify coverage or push things out of -short or anything; and don't change the set of tests/scripts/assertions\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T22:59:14.842189-06:00","updated_at":"2026-01-21T01:36:55.030606-06:00","closed_at":"2026-01-21T01:36:55.030606-06:00"}
{"id":"4hu7pvtv","title":"folders/files in ~/.local should use the full 'incrementum', not just the binary name","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-20T23:21:35.020941-06:00","updated_at":"2026-01-21T02:19:21.411415-06:00","closed_at":"2026-01-21T02:19:21.411415-06:00"}
{"id":"xkmeckqz","title":"prefix-highlighting and matching use different code","description":"`incr todo list` shows a todo id with the prefix 'r' highlighted\n\nthis appears correct:\n\n    > incr todo list | grep '^r' | wc -l\n\t   1\n\nbut it still errors as ambiguous:\n\n    > incr todo show r\n    Error: ambiguous todo ID prefix: r\n\nfigure out what's going on and fix it\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-20T23:27:35.704615-06:00","updated_at":"2026-01-21T01:14:42.978483-06:00","closed_at":"2026-01-21T01:14:42.978483-06:00"}
{"id":"ozfo7iwe","title":"only open editor if no flags or --editor","description":"`incr todo update abc def --status=done` should not try to open the editor unless I pass --editor\n\n`incr todo update abc def` should open two editors in sequence\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T23:34:49.841546-06:00","updated_at":"2026-01-21T02:02:18.259203-06:00","closed_at":"2026-01-21T02:02:18.259203-06:00"}
{"id":"e55tckxw","title":"support many $EDITOR","description":"in the commands that invoke $EDITOR, we currently error if there is more than one file to edit\n\nwe shouldn't do that, we should loop.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-20T23:35:26.379044-06:00","updated_at":"2026-01-21T01:51:30.503587-06:00","closed_at":"2026-01-21T01:51:30.503587-06:00"}
{"id":"orjc4h45","title":"Add opencode state model","description":"Define daemon/session records in state store, keyed by repo slug, with pid validation and log paths.","status":"tombstone","priority":3,"type":"feature","created_at":"2026-01-21T01:22:51.212562-06:00","updated_at":"2026-01-21T01:48:23.533151-06:00","deleted_at":"2026-01-21T01:48:23.532687-06:00"}
{"id":"z7cywc3l","title":"Implement incr opencode serve","description":"Wrap opencode serve, record daemon state (pid/host/port), and write daemon logs.","status":"tombstone","priority":3,"type":"feature","created_at":"2026-01-21T01:22:54.90703-06:00","updated_at":"2026-01-21T01:48:23.533151-06:00","deleted_at":"2026-01-21T01:48:23.532687-06:00"}
{"id":"gziexm3s","title":"Implement incr opencode run","description":"Attach to running opencode serve, create session records, and tee stdout/stderr to session logs.","status":"tombstone","priority":3,"type":"feature","created_at":"2026-01-21T01:22:59.842641-06:00","updated_at":"2026-01-21T01:48:23.533151-06:00","deleted_at":"2026-01-21T01:48:23.532687-06:00"}
{"id":"2bkf7ksa","title":"Add opencode session management commands","description":"Implement list/logs/tail/wait/kill using opencode session metadata and log files.","status":"tombstone","priority":3,"type":"feature","created_at":"2026-01-21T01:23:06.636493-06:00","updated_at":"2026-01-21T01:48:23.533151-06:00","deleted_at":"2026-01-21T01:48:23.532687-06:00"}
{"id":"uotf7cci","title":"Add opencode CLI tests","description":"Add package tests and e2e coverage for opencode subcommand behaviors.","status":"tombstone","priority":3,"type":"feature","created_at":"2026-01-21T01:23:12.424218-06:00","updated_at":"2026-01-21T01:48:23.533151-06:00","deleted_at":"2026-01-21T01:48:23.532687-06:00"}
{"id":"ptzasw2h","title":"incr todo list should include created/updated 'x ago' text","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-21T01:58:07.582401-06:00","updated_at":"2026-01-21T02:05:20.107094-06:00","closed_at":"2026-01-21T02:05:20.107094-06:00"}
{"id":"52zzurzt","title":"specs/README.md improvements","description":"make it like this (copied from a different project):\n\n| :                                        | Spec                                            | Code                                          | Purpose |\n| ---------------------------------------- | ----------------------------------------------- | --------------------------------------------- | ------- |\n| [architecture.md](./architecture.md)     | [crates/](../crates/)                           | Crate structure, server-side LLM proxy design |\n| [state-machine.md](./state-machine.md)   | [loom-core](../crates/loom-core/)               | Agent state machine for conversation flow     |\n| [tool-system.md](./tool-system.md)       | [loom-tools](../crates/loom-tools/)             | Tool registry and execution framework         |\n| [thread-system.md](./thread-system.md)   | [loom-thread](../crates/loom-thread/)           | Thread persistence and sync                   |\n| [streaming.md](./streaming.md)           | [loom-llm-service](../crates/loom-llm-service/) | SSE streaming for real-time LLM responses     |\n| [error-handling.md](./error-handling.md) | [loom-core](../crates/loom-core/)               | Error types using `thiserror`                 |\n","status":"done","priority":2,"type":"task","created_at":"2026-01-21T02:05:41.509354-06:00","updated_at":"2026-01-21T02:12:45.033513-06:00","closed_at":"2026-01-21T02:12:45.033513-06:00"}
{"id":"4ejsh3o2","title":"implement opencode spec","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-21T02:55:56.134428-06:00","updated_at":"2026-01-21T13:55:53.033484-06:00","closed_at":"2026-01-21T13:55:53.033484-06:00"}
{"id":"dy5ppaem","title":"highlight coloring in 'todo create' output","description":"i create a todo and shown the id; the first character is highlighted\n\ni 'ii todo show $id', but get an ambiguous id error\n\ni 'ii todo list' and see that the first two characters are highlighted\n\nthe prefix highlighting is a crucial semantic part of displayed IDs; audit this, fix the bug, and make sure we are consistent in all id contexts\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-21T02:58:42.036883-06:00","updated_at":"2026-01-21T14:00:28.280106-06:00","closed_at":"2026-01-21T14:00:28.280106-06:00"}
{"id":"53q3qrbz","title":"Fix testscript build when cmd/incr missing","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-21T03:13:42.420646-06:00","updated_at":"2026-01-21T12:11:28.095083-06:00","deleted_at":"2026-01-21T12:11:28.094545-06:00"}
{"id":"y3mvkpmt","title":"fix wiggum.fish move_main test to use variable","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-21T03:18:36.932278-06:00","updated_at":"2026-01-21T12:11:28.095083-06:00","deleted_at":"2026-01-21T12:11:28.094545-06:00"}
{"id":"hsisvsix","title":"Fix workspace testscript setup for missing cmd/incr","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-21T03:43:48.522506-06:00","updated_at":"2026-01-21T12:11:28.095083-06:00","deleted_at":"2026-01-21T12:11:28.094545-06:00"}
{"id":"aqo5wzri","title":"available workspaces shouldn't have a purpose","description":"we should clear purpose on release\n","status":"done","priority":2,"type":"task","created_at":"2026-01-21T12:13:05.089395-06:00","updated_at":"2026-01-21T14:02:12.887939-06:00","closed_at":"2026-01-21T14:02:12.887939-06:00"}
{"id":"gr6vrbta","title":"create todo in session start","description":"`ii session start` should accept `ii todo create`'s flags, and if I don't pass them should fall back to opening an editor\n\ni should be able to do:\n\n```\n# use some existing todo-id\nii session start abc123\n\n# create a new todo and start a session with it (editor not opened)\nii session start --title=\"do something\" --priority=4\n\n# create a new todo in my editor and start a session with it\nii session start\n\n# create a new todo, open it in my editor for further modification, and then start a session with it\nii session start --title=\"do something\" --priority=4 --edit\n```\n","status":"done","priority":2,"type":"feature","created_at":"2026-01-21T12:17:51.692584-06:00","updated_at":"2026-01-21T14:13:24.926603-06:00","closed_at":"2026-01-21T14:13:24.926603-06:00"}
{"id":"ramyohin","title":"rm workspace timeout system","description":"we should get rid of the ttl/timeout/renew system for workspaces; we don't use it\n\ninstead, a workspcae is considered held until manually released\n","status":"done","priority":2,"type":"task","created_at":"2026-01-21T13:43:28.954859-06:00","updated_at":"2026-01-21T14:07:43.009519-06:00","closed_at":"2026-01-21T14:07:43.009519-06:00"}
{"id":"j2yypxpx","title":"'todo list' should, by default, exclude status=done","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-21T14:32:17.334081-06:00","updated_at":"2026-01-21T14:37:46.242052-06:00","closed_at":"2026-01-21T14:37:46.242052-06:00"}
{"id":"22us32uo","title":"if it's more than 24h ago, we should do a timestamp rather than an 'ago' in ui tables","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-21T14:32:45.427387-06:00","updated_at":"2026-01-21T14:33:39.259688-06:00","deleted_at":"2026-01-21T14:33:39.259126-06:00"}
{"id":"2fxgiayn","title":"our 'ago' listings in ui tables should adapt resolution to recency","description":"ie: show seconds _or_ minutes _or_ hours _or_ days\n","status":"done","priority":2,"type":"task","created_at":"2026-01-21T14:33:29.712313-06:00","updated_at":"2026-01-21T14:39:27.51841-06:00","closed_at":"2026-01-21T14:39:27.51841-06:00"}
{"id":"2u3iutfd","title":"session list should only show active sessions by default","description":"let's add filter flags like 'todo list' has, so folks can do '--status=completed' or whatever if they want to see those\n\nlet's do an '--all' flag too, for all list commands across the codebase\n\nif there's logic we can share here, favor extracting a new internal package over duplicating implementation\n","status":"done","priority":2,"type":"task","created_at":"2026-01-21T14:54:32.674036-06:00","updated_at":"2026-01-21T15:13:13.803733-06:00","closed_at":"2026-01-21T15:13:13.803733-06:00"}
{"id":"4eomvvaw","title":"prefix-highlighting in todo-create output is busted","description":"☭ ~/W/incrementum uwtpkukxqtqu ◦ ⋊> incr todo create\nCreated todo 2u3iutfd: session list should only show active sessions # only the '2' is highlighted here\n☭ ~/W/incrementum uwtpkukxqtqu ◦ ⋊> incr todo update 2\nError: ambiguous todo ID prefix: 2\n\nI suspect we're failing to look at all todos to calculate prefix uniqueness here? fix that with a nice abstraction that we can be sure to use everywhere. prefer a clean domain model over spaghetti.\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-21T14:56:33.888397-06:00","updated_at":"2026-01-21T15:05:15.485876-06:00","closed_at":"2026-01-21T15:05:15.485876-06:00"}
{"id":"blwlmhbf","title":"indentation is busted on todo create $EDITOR","description":"the 2+nd line of frontmatter is indented for some reason; stop doing that\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-21T17:50:09.477951-06:00","updated_at":"2026-01-21T17:52:47.477225-06:00","closed_at":"2026-01-21T17:52:47.477225-06:00"}
{"id":"inwgx5r7","title":"Investigate workspace list after release","description":"workspace testscript acquire_release_workflow expects 'available' after release but list output is 'No workspaces found for this repository.' Review list filtering or test expectations.","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-21T19:16:35.938708-06:00","updated_at":"2026-01-21T20:12:28.430141-06:00","deleted_at":"2026-01-21T20:12:28.429531-06:00"}
{"id":"ojh2ainx","title":"Opencode run --attach UX","description":"Spec says run always attaches; accept or remove --attach flag instead of erroring when false.","status":"done","priority":2,"type":"task","created_at":"2026-01-21T21:59:48.957967-06:00","updated_at":"2026-01-22T00:44:22.3486-06:00","closed_at":"2026-01-22T00:44:22.3486-06:00"}
{"id":"7pjcwlg5","title":"Require workspace acquire --purpose","description":"Validate --purpose in CLI so errors are immediate and consistent with spec.","status":"done","priority":2,"type":"task","created_at":"2026-01-21T21:59:49.753805-06:00","updated_at":"2026-01-22T00:46:24.853726-06:00","closed_at":"2026-01-22T00:46:24.853726-06:00"}
{"id":"xvc5jmkl","title":"Avoid blocking todo prompts","description":"Detect non-tty before prompting to avoid blocking automated scripts.","status":"done","priority":2,"type":"task","created_at":"2026-01-21T21:59:50.351489-06:00","updated_at":"2026-01-22T00:51:26.406007-06:00","closed_at":"2026-01-22T00:51:26.406007-06:00"}
{"id":"roivq7aa","title":"Unify session domain model","description":"Align session model types between workspace and session packages to avoid drift.","status":"done","priority":2,"type":"task","created_at":"2026-01-21T21:59:50.929136-06:00","updated_at":"2026-01-22T00:59:18.179391-06:00","closed_at":"2026-01-22T00:59:18.179391-06:00"}
{"id":"jp4fjj2p","title":"config folder should be .incrementum, not .incr","description":"","status":"done","priority":3,"type":"task","created_at":"2026-01-22T05:35:06.851153-06:00","updated_at":"2026-01-23T02:16:18.707244-06:00","closed_at":"2026-01-23T02:16:18.707244-06:00"}
{"id":"t5sewdsw","title":"fix test organization","description":"each of our modules has,\n\n- a go api (in ./modulename)\n- a cli subcommand wrapping the go api (in ./cmd/ii)\n\nbut it seems like our test organization has gotten wonky:\n\n- we have tests of the cli wrappers in the go api packages\n- we have tests of the go api functionality in the cli wrapper package\n\nbreak off a chunk of this problem, fix it, get the tests passing, and then exit\n","status":"done","priority":2,"type":"task","created_at":"2026-01-22T15:19:41.816478-06:00","updated_at":"2026-01-22T17:02:50.83533-06:00","closed_at":"2026-01-22T17:02:50.83533-06:00"}
{"id":"oplu36j2","title":"Add e2e testscript tests for ii job do","description":"The job subcommand lacks end-to-end testscript tests.\n\nWe don't need to test the specific behavior of the job package (we do that already from the job package)\n\nbut we do want a basic smoke test that runs an `ii opencode serve` process, and while that's running, runs an `ii job do` process\n\n(the job prompt can be something easy and unambiguous, like 'in the bash tool, run `touch hello-world.txt`')\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T00:51:49.932888-06:00","updated_at":"2026-01-23T01:21:12.830016-06:00","closed_at":"2026-01-23T01:21:12.830016-06:00"}
{"id":"vd5ois7v","title":"workspace leak in todo store","description":"it looks like we're leaking workspaces with the 'todo store' purpose?\n\n☭ ~/W/incrementum vrmxpxrvtrkw ◦ ⋊> ii workspace list\nNAME STATUS PURPOSE PATH\nws-001 acquired todo store /Users/ajm/.local/share/incrementum/workspaces/...\nws-002 acquired todo store /Users/ajm/.local/share/incrementum/workspaces/...\nws-003 acquired todo store /Users/ajm/.local/share/incrementum/workspaces/...\nws-004 acquired todo store /Users/ajm/.local/share/incrementum/workspaces/...\nws-005 acquired Add e2e testscript tests for ii job do /Users/ajm/.local/share/incrementum/workspaces/...\n\n1. make the 'purpose' strings more specific here; maybe include argv (or any specific thing about the particular todo store operation)\n2. if the bug jumps out to you, go ahead and fix it (if it doesn't, that's fine, we can run with the new logs and see what we learn)\n\nmake sure to run the full `go test ./...` to validate\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T00:59:07.156268-06:00","updated_at":"2026-01-23T01:46:42.395157-06:00","closed_at":"2026-01-23T01:46:42.395157-06:00"}
{"id":"lexjdtti","title":"`ii workspace list` should have a column that says how long a workspace has been acquired for","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T00:59:50.303271-06:00","updated_at":"2026-01-23T01:49:22.557348-06:00","closed_at":"2026-01-23T01:49:22.557348-06:00"}
{"id":"nm764t6w","title":"`ii job list` should show the workspace id (or if that's inconvenient, at least the session id)","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T01:00:43.04892-06:00","updated_at":"2026-01-23T01:52:13.312418-06:00","closed_at":"2026-01-23T01:52:13.312418-06:00"}
{"id":"mvs364nl","title":"clean up .incrementum-xyz files","description":"we create files like .incrementum-commit-message and .incrementum-feedback in the job package, as a means of sending messages from opencode back out to the workflow\n\nwe need to clean up these files after we read them; they're meant to be transient\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T01:08:23.168925-06:00","updated_at":"2026-01-23T01:54:38.688872-06:00","closed_at":"2026-01-23T01:54:38.688872-06:00"}
{"id":"k4c3sx72","title":"`ii workspace list` should include available workspaces by default","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T01:09:23.946814-06:00","updated_at":"2026-01-23T01:56:33.541873-06:00","closed_at":"2026-01-23T01:56:33.541873-06:00"}
{"id":"lluivfbg","title":"stale workspace bug in job do","description":"somewhere in the job workflow i got a 'stale workspace' jujutsu error\n\na \"stale workspace\" happens when one workspace (\"B\") modifies either the working change nof any other workspace (\"A\") or any ancestor thereof\n\nwhen this happens, workspace A needs to run 'jj workspace update-stale' to manually propagate those changes on disk before any other jj command will succeed\n\nof course, a cleaner way around this (when practical) is to avoid having any workspace operate on a parent of another workspace, but that might be tricky in this case because the review agent needs to be in the change with the diff under review\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T01:13:22.369921-06:00","updated_at":"2026-01-23T02:02:26.90314-06:00","closed_at":"2026-01-23T02:02:26.90314-06:00"}
{"id":"jk6tlfjd","title":"todo not found","description":"> ii job list --all\n> JOB TODO STAGE STATUS AGE\n> wwuplbbbtf jp4fjj2p implementing failed 0s\n> rtbvoxtet5 jp4fjj2p implementing failed 0s\n> lczn7o2ct7 oplu36j2 committing failed 8m\n\n> ii todo show oplu\n> ID: oplu36j2\n> Title: Add e2e testscript tests for ii job do\n> Type: task\n> Status: in_progress\n> Priority: medium (2)\n> Created: 2026-01-23 00:51:49\n> Updated: 2026-01-23 00:56:48\n\nDescription:\nThe job subcommand lacks end-to-end testscript tests.\n\nWe don't need to test the specific behavior of the job package (we do that already from the job package)\n\nbut we do want a basic smoke test that runs an `ii opencode serve` process, and while that's running, runs an `ii job do` process\n\n(the job prompt can be something easy and unambiguous, like 'in the bash tool, run `touch hello-world.txt`')\n\n> ii session fail oplu36j2\n> Error: todo not found\n> Usage:\n> ii session fail [todo-id] [flags]\n\nFlags:\n-h, --help help for fail\n\nexit status 1\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T01:17:53.788109-06:00","updated_at":"2026-01-23T02:12:01.565739-06:00","closed_at":"2026-01-23T02:12:01.565739-06:00"}
{"id":"i6dq22y3","title":"see what we can learn from jsonfile","description":"here's a library jsonfile.go. are there any lessons we can learn from it and apply to our own json state file management? if so, apply them.\n\n// Copyright (c) David Crawshaw\n// SPDX-License-Identifier: BSD-3-Clause\n\n// Package jsonfile persists a Go value to a JSON file.\npackage jsonfile\n\nimport (\n\"bytes\"\n\"encoding/json\"\n\"fmt\"\n\"os\"\n\"path/filepath\"\n\"sync\"\n)\n\n// JSONFile holds a Go value of type Data and persists it to a JSON file.\n// Data is accessed and modified using the Read and Write methods.\n// Create a JSONFile using the New or Load functions.\ntype JSONFile[Data any] struct {\npath string\n\n    mu    sync.RWMutex\n    bytes []byte\n    data  *Data\n\n}\n\n// New creates a new empty JSONFile at the given path.\nfunc New[Data any](path string) (*JSONFile[Data], error) {\np := &JSONFile[Data]{path: path, bytes: []byte(\"{}\"), data: new(Data)}\nif err := p.Write(func(*Data) error { return nil }); err != nil {\nreturn nil, fmt.Errorf(\"jsonfile.New: %w\", err)\n}\nreturn p, nil\n}\n\n// Load loads an existing JSONFileData from the given path.\n//\n// If the file does not exist, Load returns an error that can be\n// checked with os.IsNotExist.\n//\n// Load and New are separate to avoid creating a new file when\n// starting a service, which could lead to data loss. To both load an\n// existing file or create it (which you may want to do in a development\n// environment), combine Load with New, like this:\n//\n// db, err := jsonfile.Load[Data](path)\n// if os.IsNotExist(err) {\n// db, err = jsonfile.New[Data](path)\n// }\nfunc Load[Data any](path string) (\\*JSONFile[Data], error) {\np := &JSONFile[Data]{path: path, data: new(Data)}\nvar err error\np.bytes, err = os.ReadFile(path)\nif err != nil {\nreturn nil, fmt.Errorf(\"jsonfile.Load: %w\", err)\n}\nif err := json.Unmarshal(p.bytes, p.data); err != nil {\nreturn nil, fmt.Errorf(\"jsonfile.Load: %w\", err)\n}\nreturn p, nil\n}\n\n// Read calls fn with the current copy of the data.\nfunc (p *JSONFile[Data]) Read(fn func(data *Data)) {\np.mu.RLock()\ndefer p.mu.RUnlock()\nfn(p.data)\n}\n\n// Write calls fn with a copy of the data, then writes the changes to the file.\n// If fn returns an error, Write does not change the file and returns the error.\nfunc (p *JSONFile[Data]) Write(fn func(*Data) error) error {\np.mu.Lock()\ndefer p.mu.Unlock()\n\n    data := new(Data) // operate on copy to allow concurrent reads and rollback\n    if err := json.Unmarshal(p.bytes, data); err != nil {\n    \treturn fmt.Errorf(\"JSONFile.Write: %w\", err)\n    }\n    if err := fn(data); err != nil {\n    \treturn err\n    }\n    b, err := json.Marshal(data)\n    if err != nil {\n    \treturn fmt.Errorf(\"JSONFile.Write: %w\", err)\n    }\n    if bytes.Equal(b, p.bytes) {\n    \treturn nil // no change\n    }\n\n    f, err := os.CreateTemp(filepath.Dir(p.path), filepath.Base(p.path)+\".tmp\")\n    if err != nil {\n    \treturn fmt.Errorf(\"JSONFile.Write: temp: %w\", err)\n    }\n    _, err = f.Write(b)\n    if err1 := f.Close(); err1 != nil && err == nil {\n    \terr = err1\n    }\n    if err != nil {\n    \treturn fmt.Errorf(\"JSONFile.Write: %w\", err)\n    }\n    if err := os.Rename(f.Name(), p.path); err != nil {\n    \treturn fmt.Errorf(\"JSONFile.Write: rename: %w\", err)\n    }\n\n    data = new(Data) // avoid any aliased memory\n    if err := json.Unmarshal(b, data); err != nil {\n    \treturn fmt.Errorf(\"JSONFile.Write: %w\", err)\n    }\n\n    p.data = data\n    p.bytes = b\n    return nil\n\n}\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T01:33:21.085841-06:00","updated_at":"2026-01-23T02:14:44.251196-06:00","closed_at":"2026-01-23T02:14:44.251196-06:00"}
{"id":"gdke5jvl","title":"add a README.md","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T02:28:17.596666-06:00","updated_at":"2026-01-23T04:29:30.136673-06:00","closed_at":"2026-01-23T04:29:30.136673-06:00"}
{"id":"d62pz2jo","title":"when a job creates a session, it should include its job id in the session topic","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T02:30:02.994485-06:00","updated_at":"2026-01-23T14:54:04.123488-06:00","closed_at":"2026-01-23T14:54:04.123488-06:00"}
{"id":"esxf6v2q","title":"leaking workspaces","description":"some todo store operation is leaking workspaces:\n\n☭ ~/W/incrementum nqqmzklpxqvy ● ⋊> ii workspace list\nNAME STATUS ACQUIRED PURPOSE PATH\nws-001 acquired 4m todo store (job run gdke5jvl) /Users/ajm/.local/share/incrementum/workspaces/...\nws-002 acquired 4m todo store (job run gd) /Users/ajm/.local/share/incrementum/workspaces/...\nws-003 acquired 4m todo store (session for job gd) /Users/ajm/.local/share/incrementum/workspaces/...\n\nthat a workspace created for a todo store operation is still acquired after 4 minutes is certainly a bug\n\nif you can find the bug, great, fix it. if not, add more detail to the PURPOSE such that we might identify the bad callsite more easily in the future.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T02:34:31.788086-06:00","updated_at":"2026-01-23T15:14:53.456412-06:00","closed_at":"2026-01-23T15:14:53.456412-06:00"}
{"id":"kqr5tart","title":"simplify: 'opencode' module shouldn't do sessions/workspaces","description":"'ii opencode run' shouldn't allocate sessions or workspaces; if a caller wants to run it in in a workspace, it can. it should run in the directory where it's invoked.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T02:40:09.301516-06:00","updated_at":"2026-01-23T13:19:09.663465-06:00","closed_at":"2026-01-23T13:19:09.663465-06:00"}
{"id":"tnondi5u","title":"ii job is juggling workspaces incorrectly","description":"- I run `ii job do xyz` from my repo's default workspace, ~/Work/incrementum\n- it checks out a session in workspace ws-003; cool; seems legit\n- it makes the code change\n- it does the feedback and commit message stuff\n- it tries to read the commit message and fails:\n\nError: read commit message: open /Users/ajm/.local/share/incrementum/workspaces/users-ajm-work-incrementum/ws-003/.incrementum-co\nmmit-message: no such file or directory\nexit status 1\n\n- I see that the commit message, the approval, and the code change were written to my default workspace, not to ws-003:\n\n☭ ~/W/incrementum qsnwsmqouvqq ● ⋊> jj st\nWorking copy changes:\nA .incrementum-commit-message\nA .incrementum-feedback\nA README.md\nWorking copy (@) : qsnwsmqo 1a27b7da (no description set)\nParent commit (@-): usqrnnnq a5ad1d38 opencode shouldn't use sessions; you can run it in a session if you want\n\n^ that's the problem; we should be making sure to run opencode _within_ the workspace we've acquired for this job\n\nnot sure if the bug is in the job module or the opencode module or somewhere else\n\nstepping out a bit: it seems like 'job do' could... never possibly succeed with this bug? how do we not have test coverage here? i feel like 'make a repo, make a todo, do a job to close the todo' is the sort of smoke test we really ought to have. do we have that and it's passing for some reason despite the bug, or do we not have it?\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T03:12:51.522308-06:00","updated_at":"2026-01-23T04:12:51.187615-06:00","closed_at":"2026-01-23T04:12:51.187615-06:00"}
{"id":"tqmueu2c","title":"'ii job do' rev handling","description":"'ii job do' with no --rev passed should make a new change 'jj new \"trunk()\"' and start a session there\n\n'ii job do' with --rev should make a new change 'jj new <rev>' and start a session there\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T04:32:07.420624-06:00","updated_at":"2026-01-23T13:15:05.814462-06:00","closed_at":"2026-01-23T13:15:05.814462-06:00"}
{"id":"bnfssduu","title":"test: list files in working directory","description":"ls\nAGENTS.md\nbin\ncmd\ngo.mod\ngo.sum\ninternal\njob\nprompt.md\nREADME.md\nsession\nspecs\ntodo\ntodos.jsonl\nwiggum.fish\nworkspace\n\njj show\nCommit ID: 08b953dcccae71c085b2c65430dc72895bd0f813\nChange ID: mpuvzmzmowvzxosploytxnxqvllqmolw\nAuthor   : Andrew Monks <a@monks.co> (11 seconds ago)\nCommitter: Andrew Monks <a@monks.co> (11 seconds ago)\n\n    (no description set)","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-23T13:18:32.140529-06:00","updated_at":"2026-01-23T15:08:25.648356-06:00","deleted_at":"2026-01-23T15:08:25.647369-06:00"}
{"id":"cjngbz4p","title":"job do without --rev opens workspace in wrong change","description":"'ii job do' without a --rev flag should open its workspace in a commit that is the result of 'jj new \"trunk()\"'; it appears to currently open its workspace in a commit that is the result of 'jj new \"root()\"'.\n\nit's possible the repos we use for testing aren't interesting enough to reveal this difference? maybe that's hard to do, even. But, whether or not we can easily test this behavior, we still need to fix it.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T13:23:34.948346-06:00","updated_at":"2026-01-23T13:42:03.763016-06:00","closed_at":"2026-01-23T13:42:03.763016-06:00"}
{"id":"bzgu4hcx","title":"for todo read operations, we don't need to check out a workspace","description":"we need a workspace to _write_ to the todo storage change, but we don't need a workspace to _read_ from it; we can read the state by `jj file show -r whatever/revision some_file.json`\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T13:51:41.406916-06:00","updated_at":"2026-01-23T15:21:20.774039-06:00","closed_at":"2026-01-23T15:21:20.774039-06:00"}
{"id":"gq24pvix","title":"workspace dir in prompts?","description":"it's weird that our prompt templates for the 'job' feature specify what folder to work in\n\nthe agents reliably understand that they should work in getwd(), which ought to be correctly set to the workspace we use\n\nfor this task:\n\n- play around with opencode and 'ii opencode' with your shell tool, and try to probe it to ensure that each run gets the cwd we expect; perhaps ask it to write \"$(pwd)\" to a file or something\n- add some logging to the top of the 'job do' command. it should report:\n  - the workspace it's working in\n  - the session id it's working in\n  - the full content of the todo it's working on\n  - the change id that's checked out in its workspace\n  - the absolute path to its working directory\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T14:13:48.072864-06:00","updated_at":"2026-01-23T14:25:45.318717-06:00","closed_at":"2026-01-23T14:25:45.318717-06:00"}
{"id":"u33cq7aa","title":"Consolidate ID generation into internal/ids/generate.go","description":"job/id.go, todo/id.go, and workspace/session.go all implement identical SHA-256 + base32 ID generation. Create a shared function: func Generate(input string, length int) string","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:04:13.44875-06:00","updated_at":"2026-01-23T15:23:22.656017-06:00","closed_at":"2026-01-23T15:23:22.656017-06:00"}
{"id":"tkh6qk3s","title":"Extract validStatusList helpers into internal/validation","description":"session/errors.go, job/errors.go, and todo/validation.go have duplicate validStatusList/validTypeList helpers. Create a generic FormatValidValues function.","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:04:15.166557-06:00","updated_at":"2026-01-23T15:26:08.705238-06:00","closed_at":"2026-01-23T15:26:08.705238-06:00"}
{"id":"kiy23mfd","title":"Extract state directory resolution to internal/paths","description":"job/manager.go and workspace/pool.go both resolve ~/.local/state/incrementum. Create internal/paths with DefaultStateDir() and DefaultWorkspacesDir().","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:04:17.236102-06:00","updated_at":"2026-01-23T15:28:38.353154-06:00","closed_at":"2026-01-23T15:28:38.353154-06:00"}
{"id":"v6mqxnjm","title":"Split cmd/ii/todo.go into smaller files","description":"todo.go is 1050 lines - a god file. Split into: todo_commands.go (definitions/flags), todo_table.go (table formatting), todo_detail.go (detail view), todo_tree.go (dependency tree).","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:04:21.357417-06:00","updated_at":"2026-01-23T15:33:19.238918-06:00","closed_at":"2026-01-23T15:33:19.238918-06:00"}
{"id":"5h3ydjux","title":"Refactor job/runner.go Run() function","description":"Run() is 173 lines (58-231) with 5-6 levels of nesting. Extract stage orchestration and interrupt handling into smaller methods.","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:04:21.986664-06:00","updated_at":"2026-01-23T15:36:18.028394-06:00","closed_at":"2026-01-23T15:36:18.028394-06:00"}
{"id":"gd2pdgoq","title":"Create options structs for functions with many parameters","description":"runCommittingStage takes 8 params, formatJobTable takes 6. Create CommittingStageOptions, TableFormatOptions structs to reduce parameter count.","status":"done","priority":3,"type":"task","created_at":"2026-01-23T15:04:22.165149-06:00","updated_at":"2026-01-23T16:09:38.244798-06:00","closed_at":"2026-01-23T16:09:38.244798-06:00"}
{"id":"yipe6nmj","title":"Consolidate workspace errors into workspace/errors.go","description":"Workspace errors are scattered across pool.go, session.go, opencode.go, opencode_daemon.go. Consolidate into errors.go like job and session packages.","status":"done","priority":3,"type":"task","created_at":"2026-01-23T15:04:22.585348-06:00","updated_at":"2026-01-23T16:12:12.647829-06:00","closed_at":"2026-01-23T16:12:12.647829-06:00"}
{"id":"ajwx2hxk","title":"Standardize ID length across all entity types","description":"Todo IDs are 8 chars, Job/Session/Opencode IDs are 10 chars. Standardize to single length (8 recommended for usability).","status":"done","priority":3,"type":"task","created_at":"2026-01-23T15:04:23.382121-06:00","updated_at":"2026-01-23T16:15:01.184383-06:00","closed_at":"2026-01-23T16:15:01.184383-06:00"}
{"id":"buxep5e7","title":"Add IsValid/ValidStatuses to WorkspaceStatus","description":"workspace/state.go WorkspaceStatus lacks ValidStatuses() and IsValid() methods unlike all other status types in the codebase.","status":"done","priority":3,"type":"task","created_at":"2026-01-23T15:04:24.278755-06:00","updated_at":"2026-01-23T16:17:24.758988-06:00","closed_at":"2026-01-23T16:17:24.758988-06:00"}
{"id":"f27vlddt","title":"Create internal/strings/normalize.go for whitespace normalization","description":"session/manager.go normalizeSessionTopic and todo/store.go normalizePurpose are identical. Extract to shared NormalizeWhitespace function.","status":"done","priority":4,"type":"task","created_at":"2026-01-23T15:04:25.365447-06:00","updated_at":"2026-01-23T16:19:54.368078-06:00","closed_at":"2026-01-23T16:19:54.368078-06:00"}
{"id":"rfk4qlaf","title":"Extract generic table builder to internal/ui","description":"formatJobTable, formatSessionTable, formatTodoTable in cmd/ii follow identical patterns. Create a generic table builder.","status":"done","priority":4,"type":"task","created_at":"2026-01-23T15:04:26.057759-06:00","updated_at":"2026-01-23T16:24:43.943518-06:00","closed_at":"2026-01-23T16:24:43.943518-06:00"}
{"id":"tsgj6hpv","title":"Consolidate highlighter factory functions","description":"todoLogHighlighter and jobLogHighlighter in cmd/ii are nearly identical. Create shared highlighter factory.","status":"done","priority":4,"type":"task","created_at":"2026-01-23T15:04:26.8664-06:00","updated_at":"2026-01-23T16:27:13.532938-06:00","closed_at":"2026-01-23T16:27:13.532938-06:00"}
{"id":"ppicrcq2","title":"Create hasChangedFlags helper for cobra flag checking","description":"todoCreateHasCreateFlags and sessionStartHasCreateFlags have similar 6-condition OR expressions. Create helper: hasChangedFlags(cmd, flags...string) bool","status":"done","priority":4,"type":"task","created_at":"2026-01-23T15:04:27.644079-06:00","updated_at":"2026-01-23T16:34:43.97039-06:00","closed_at":"2026-01-23T16:34:43.97039-06:00"}
{"id":"6nmzyjkp","title":"todo create: title should be a flag, not a positional argument","description":"remember to update callers and tests across all packages\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:05:05.55811-06:00","updated_at":"2026-01-23T15:39:51.918591-06:00","closed_at":"2026-01-23T15:39:51.918591-06:00"}
{"id":"xnk47ch5","title":"workspace list should include the revision it was opened to","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:09:54.813405-06:00","updated_at":"2026-01-23T16:05:39.129112-06:00","closed_at":"2026-01-23T16:05:39.129112-06:00"}
{"id":"473iep35","title":"simplify: 'job' can not engage with sessions/workspaces","description":"let's make jobs just happen in cwd, rather than checking out a session or workspace. if a caller wants to run it in a workspace or on a particular change, they can. no more '--ref' flag.\n\nthis means the job system will have to manually mark the todo as in-progress and then as done (or reopen on error or whatever) (since it won't be getting this behavior from the session anymore)\n","status":"done","priority":1,"type":"task","created_at":"2026-01-23T15:27:38.804879-06:00","updated_at":"2026-01-23T16:02:18.059884-06:00","closed_at":"2026-01-23T16:02:18.059884-06:00"}
{"id":"nms4g734","title":"get rid of the 'session' module and subcommand","description":"doing workspaces/todos manually is fine; I don't think we actually need an abstraction here\n","status":"done","priority":4,"type":"task","created_at":"2026-01-23T15:37:50.271411-06:00","updated_at":"2026-01-23T16:40:25.057496-06:00","closed_at":"2026-01-23T16:40:25.057496-06:00"}
{"id":"hfknlzgr","title":"incr.toml should be incrementum.toml","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T15:39:17.084516-06:00","updated_at":"2026-01-23T16:07:31.454385-06:00","closed_at":"2026-01-23T16:07:31.454385-06:00"}
{"id":"vlbx4wqi","title":"does cobra let us express flag aliases (eg --desc for --description) such that they don't appear on two separate lines of help? I'd rather have the short name listed inline","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-23T16:25:15.81595-06:00","updated_at":"2026-01-23T16:33:00.827208-06:00","closed_at":"2026-01-23T16:33:00.827208-06:00"}
{"id":"l7654yti","title":"simplify: get rid of 'opencode' daemon","description":"instead of the server/daemon thing (so let's get rid of 'ii opencode serve'), let's just shell out to 'opencode run' directly. We don't have to capture our own logs, we can get them by spelunking the ~/.local/share/opencode directory, so our log commands should do that. let's get rid of the 'start/wait' interface, and just run to completion; callers can '&' or whatever if they want. remember to make the job system use the new interface correctly.\n\nReconstructing a Session\n\nGiven: sessionID = \"ses_abc123\"\n\n1. List messages (direct lookup)\n\n   ls ~/.local/share/opencode/storage/message/ses_abc123/\n\n2. For each message, get parts\n\n   ls ~/.local/share/opencode/storage/part/{messageID}/\n\n3. For session metadata, you'd need to scan or know projectID\n\n   find ~/.local/share/opencode/storage/session -name \"ses_abc123.json\"\n\nLook at these files to see what the formats look like.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T17:27:18.936052-06:00","updated_at":"2026-01-23T18:03:07.474912-06:00","closed_at":"2026-01-23T18:03:07.474912-06:00"}
{"id":"xy5m4vtb","title":"check out 'age' column on 'ii <subcommand> list'","description":"'AGE' should be time.Now().Sub(x.CreatedAt), not any other measurement; let's add a separate \"DURATION\" column that shows,\n\n    if x.is_active()    # whatever this means for x\n      time.Now.Sub(x.CreatedAt)\n    else\n      session.UpdatedAt.Sub(x.CreatedAt)\n\nacross the board for all 'list' commands\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T18:07:13.039391-06:00","updated_at":"2026-01-23T19:10:22.242718-06:00","closed_at":"2026-01-23T19:10:22.242718-06:00"}
{"id":"pwp6mdgq","title":"audit opencode session list bookkeeping","description":"I started an opencode session with 'ii job do xyz', and it is still running, but i do not see it in 'ii opencode list' -- are we failing to use the opencode package from the job package? is the opencode package failing to bookkeep the list? figure out what's going on here and fix it\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T18:10:28.564909-06:00","updated_at":"2026-01-23T18:46:33.300301-06:00","closed_at":"2026-01-23T18:46:33.300301-06:00"}
{"id":"6cgjuyqo","title":"s/describe/commit","description":"when a job commits, it should use 'jj commit' rather than 'jj describe' so that the working tree is left on a new empty commit with the job's work in its parent\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T18:28:42.184602-06:00","updated_at":"2026-01-23T18:31:14.688382-06:00","closed_at":"2026-01-23T18:31:14.688382-06:00"}
{"id":"drlcwryn","title":"add work loop to job system","description":"our job system should use a loop: instead of asking an opencode run to complete the _entire_ task, we should ask it to complete the highest priority part of the task (or do nothing if the task is complete), check if it made any changes, test and review, and loop until the well is dry. _Then_ review the whole project. We should have a loop like this for the initial work, and also for the work of responding to change requests from code review or acceptance testing.\n\nThe insight here is that agents' work quality decreases the longer they're active (really: the larger their context grows), so it's better to run a sequence of short-running agents than a single long-running one.\n\nWe should do this loop for all jobs without exception -- this isn't a flag or anything, it's just how the system should work.\n\nI think I want something like this (just off the cuff, probably sloppy, probably missing stuff--the important stuff is that we test, review, and commit each step, in a loop, then when that loop terminates, review and test the whole commit sequence)\n\n    last_hash: string\n    done = false\n    next_step_prompt(todo) = \"do the next step towards ${todo}; then, output a nice multi-line commit message to ${commit_message_path} describing the step and its implementation\"\n    fix_tests_prompt(todo, test_log) = \"fix the tests ${test_log}; intent was ${cat commit_message_path} as a step towards ${todo}\"\n    how_to_review() = \"if you approve this change, create the file APPROVE.txt. If this change is directionally reasonable but needs some changes, write your review with any change requests to ${code_review_path}. If this change is a lost cause, create the file REJECT.txt.\"\n    commit_review_prompt(todo) = \"the diff in the working tree is a proposed commit intended to move us towards completing ${todo}, with a description in the commit message at ${commit_message_path}. review the proposed commit: does it do what the message says? does it move us towards the goal? is it free of defects? does it include reasonable test coverage? does it conform to the norms of the code around it? does it work? ${how_to_review()}\"\n    project_review_prompt(todo) = \"the last ${n} commits in the working tree have an implementation which is intended to resolve ${todo}. review it: is the todo resolved completely and successfully? inspect automated tests; you may also perform manual tests if needed. ${how_to_review()}\"\n    respond_to_feedback_prompt(todo, feedback): \"blah blah blah you get the gist\"\n\n    do_job(todo):\n        label start\n        while True:\n            hash_before_step = jj.show()\n\n            prompt(next_step_prompt(todo))\n            label change_attempted\n\n            commit_message = cat ${commit_message_path}\n            rm ${commit_message_path}\n\n            while ! run_tests():\n                prompt(fix_tests_prompt(todo, test_log))\n\n            # if we got through this loop without making any changes, jump to project review\n            if jj.show() == hash_before_step:\n                break\n\n            # we made changes, let's review them\n            while ! commit_review_prompt(todo, commit_message):\n                if rejected():\n                    jj abandon\n                    continue\n\n                while True:\n                    hash_before_feedback_response = jj.show()\n                    prompt(respond_to_feedback_prompt(todo, feedback))\n                    if jj.show() == hash_before_feedback_response:\n                        goto change_attempted\n\n            # this change passes review; commit\n            jj commit -m \"${commit_message}, ${todo}\"\n\n            # make another change\n            continue\n\n        label project_attempted\n\n        while ! run_tests():\n            prompt(fix_tests_prompt(todo, test_log))\n\n        while ! prompt(project_review_prompt(todo))\n            if rejected():\n                jj abandon first_new_commit::last_new_commit\n                goto start\n\n            prompt(respond_to_feedback_prompt(todo, feedback)):\n                goto project_attempted\n\n        return done\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T18:46:53.004614-06:00","updated_at":"2026-01-23T21:46:51.165787-06:00","closed_at":"2026-01-23T21:46:51.165787-06:00"}
{"id":"bt7habhy","title":"better table rendering with lipgloss","description":"Our tables should be printed at viewport width\n\nI think charmbracelet/lipgloss has good table stuff, let's use that. (It's cloned to ~/Work/lipgloss so you can see the source/docs).\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T18:57:06.815091-06:00","updated_at":"2026-01-23T21:59:02.130475-06:00","closed_at":"2026-01-23T21:59:02.130475-06:00"}
{"id":"ug34kqio","title":"put more stuff in commit messages","description":"- the full todo (not just the title and id)\n- transcripts of all opencode sessions (not tool calls, just prose messages)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T21:57:21.490343-06:00","updated_at":"2026-01-24T00:31:29.623554-06:00","closed_at":"2026-01-24T00:31:29.623554-06:00"}
{"id":"2ip7lkti","title":"opencode list width is wrong","description":"the \"PROMPT\" column is wrapping onto two lines _and_ truncating with ellipsis\n\nshould truncate at the right width to make it fit on one line\n\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T22:00:58.007208-06:00","updated_at":"2026-01-24T02:13:08.154249-06:00","closed_at":"2026-01-24T02:13:08.154249-06:00"}
{"id":"ltwmamix","title":"clean up templates","description":"we have a folder called \"prompts\" with a template called \"commit.tmpl\", which is not a prompt\n\nlet's rename the folder to \"templates\" and give the files these names:\n\n- commit-message.tmpl\n- prompt-implementation.tmpl\n- prompt-project-review.tmpl\n- prompt-commit-review.tmpl\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T22:24:46.614348-06:00","updated_at":"2026-01-23T23:19:51.538914-06:00","closed_at":"2026-01-23T23:19:51.538914-06:00"}
{"id":"s5fniguy","title":"pass commit message into commit review prompt","description":"it looks like our commit review agent can't find the commit message, which is mentioned in its prompt\n\nif we've already read and deleted .incrementum-commit-message, that's fine, we can inject the message into the template in some fake xml tags.\n\nEither way: the agent needs to be able to read the message in order to complete its assignment.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T22:26:25.944282-06:00","updated_at":"2026-01-23T22:46:56.912318-06:00","closed_at":"2026-01-23T22:46:56.912318-06:00"}
{"id":"rjxcnorb","title":"debug missing commit message","description":"shortly after some opencode agent execution finishes, i get this error and 'ii job do' exits 1:\n\nError: read commit message: open /Users/ajm/Work/incrementum/.incrementum-commit-message: no such f\nile or directory\n\nA) we should have better error handling here; the error output should be clear: why were we trying to read that? who was supposed to write it? what were we trying to do?\n\nB) why doesn't the file exist? did we already read and delete it? did we prompt the agent to write it in the first place? this is happening pretty consistently; I don't think it's a weird one-off\n\nC) since this is happening consistently, I feel like a test should have caught that? do we not have a smoke test that exercises real-live opencode to accomplish a task and create a message and review it and whatnot? or do we have a test like that and it's passing and this is failing for some other reason?\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T23:27:10.640146-06:00","updated_at":"2026-01-24T00:28:35.600696-06:00","closed_at":"2026-01-24T00:28:35.600696-06:00"}
{"id":"z6bifgjl","title":"log more in job package","description":"we should log:\n\n- commit messages\n- prompts\n- code reviews\n- etc\n\nuse lipgloss to do some nice formatting\n","status":"done","priority":2,"type":"task","created_at":"2026-01-23T23:42:30.731275-06:00","updated_at":"2026-01-24T00:48:01.638977-06:00","closed_at":"2026-01-24T00:48:01.638977-06:00"}
{"id":"rlytkdx5","title":"Remove fallback message path mechanism (backwards compatibility no longer needed)","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-24T00:10:08.636069-06:00","updated_at":"2026-01-24T02:54:33.242092-06:00","closed_at":"2026-01-24T02:54:33.242092-06:00"}
{"id":"2prc7fvg","title":"pass commits to templates","description":"we should pass a log of the commits so far (ids and full messages) into all of our prompts: implemetors should see the commits towards the todo so far (if any), commit reviewers should see the list of previous commits made for this todo prior to the commit they're reviewing, and full-todo reviewers should get the full list of commits that make up the todo's proposed resolution\n\n1. accumulate these while doing work\n2. pass them into the templates\n3. render them in the templates\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T00:13:09.67349-06:00","updated_at":"2026-01-24T02:11:50.258549-06:00","closed_at":"2026-01-24T02:11:50.258549-06:00"}
{"id":"bzihu2of","title":"put commit message in feedback section of impl prompt","description":"in prompt-implementation.tmpl, in the branch of the template where we're\nresponding to feedback, we should include the commit message we wrote when we\nmade the previous version of the change.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T00:37:24.440609-06:00","updated_at":"2026-01-24T02:24:18.973489-06:00","closed_at":"2026-01-24T02:24:18.973489-06:00"}
{"id":"psx6scwq","title":"refactor templates","description":"our templates have a lot of repetition: the review questions, the review instructions, the todo block, othres\n\nlet's add an abstraction here. Be circumspect about where we add strings to the template input api, vs where we use text/template's other abstraction mechanisms: the templates are user-configurable, so we shouldn't pass things in that don't make sense to. The review instructions make sense to pass (they're part of our API), and the todo makes sense to pass (same) but the review questions probably don't; it would be weird for a user to want to import our review questions. Use your judgement for other cases.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T00:42:48.874591-06:00","updated_at":"2026-01-24T02:34:44.029009-06:00","closed_at":"2026-01-24T02:34:44.029009-06:00"}
{"id":"j7kvfykv","title":"remove duration from todo list","description":"i guess this is one list where duration doesn't really make sense, huh\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T00:50:17.235505-06:00","updated_at":"2026-01-24T02:57:13.944522-06:00","closed_at":"2026-01-24T02:57:13.944522-06:00"}
{"id":"cy5drzfq","title":"add 'opencode' package","description":"each cli module should be a thin wrapper around a public go package; the go package should provide an api that is basically 1-1 with the cli interface (every other go package should be internal)\n\nmake opencode be like this\n\nalso: move the opencode types out of the workspace package\n\nwhen 'job' invokes opencode, it should use the opencode package\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T01:49:35.507884-06:00","updated_at":"2026-01-24T03:26:55.695679-06:00","closed_at":"2026-01-24T03:26:55.695679-06:00"}
{"id":"fhbjgrcf","title":"change how we read events from opencode","description":"this is a big change to the opencode package.\n\nthe point of it is to get go callers of opencode run a relatively-low-latency event stream\n\ncurrently we read events from opencode's log files; instead, we should stream them from the server process.\n\nyou can do 'opencode run --port=xxx --hostname=localhost <some-prompt>', and then 'GET localhost:xxx/event' to get an SSE stream.\n\nproblem with that is: we might miss the first couple events. instead, we should do this in three steps:\n\n1. opencode serve --port=xxx --hostname=localhost\n2. GET http://localhost:xxx/event\n3. opencode run --attach=\"http://localhost:xxx\" <some-prompt>\n\nthis means we shell out _twice in parallel_ for each opencode run, but that's ok\n\nwe should write those events to our own storage in ~/local/share/incrementum\n\nthe go library version of opencode run should return an event channel so the caller can get the full event stream\n\nwe should remove the 'ii opencode tail' command, since it would now have to work across processes; it isn't that important. 'ii opencode logs' can just read _our_ copy of the events from disk.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T02:12:24.927995-06:00","updated_at":"2026-01-24T04:16:07.179186-06:00","closed_at":"2026-01-24T04:16:07.179186-06:00"}
{"id":"34i5adhn","title":"fix factoring","description":"rules:\n\n- every public go package (in ./) should back a cli subcommand\n- the cli package (./cmd/ii) should be a thin wrapper over the public go packages\n- besides these subcommand-backing packages and the cli package, every other package should be in ./internal/\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T02:15:35.492629-06:00","updated_at":"2026-01-24T05:45:10.349568-06:00","closed_at":"2026-01-24T05:45:10.349568-06:00"}
{"id":"uqhwlv7l","title":"split feedback and implementation prompts","description":"let's make the 'respond to feedback' prompt and the 'implementation' prompt distinct files\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T02:31:01.252235-06:00","updated_at":"2026-01-24T05:49:44.81375-06:00","closed_at":"2026-01-24T05:49:44.81375-06:00"}
{"id":"kxberf5g","title":"don't put commit log into prompts when it has length 0","description":"[see title]\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T02:33:18.648344-06:00","updated_at":"2026-01-24T05:57:43.166824-06:00","closed_at":"2026-01-24T05:57:43.166824-06:00"}
{"id":"4ljrxryb","title":"dependencies are too complex","description":"let's have only one type of dependency (so remove the type field).\n\nthat way, we can easily make the \"added dependency\" logs very clear -- they are currently confusing because the default 'blocks' makes the relationship sound reversed\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T02:42:25.435215-06:00","updated_at":"2026-01-24T06:11:22.714059-06:00","closed_at":"2026-01-24T06:11:22.714059-06:00"}
{"id":"vvuvp2gg","title":"swarm subcommand","description":"let's add a new subcommand (remember that subcommands are thin wrappers around the api of a corresponding public go package) 'swarm', for orchestrating many parallel 'job' runs\n\nsince jobs should run in parallel, they'll each need a workspace. when the orchestrator starts a job, it should make a new empty change with 'main' as its parent, create a workspace on that change, and run the job with that workspace as its working directory.\n\nsince we want to be able to easily coordinate jobs that are running concurrently, we'll run them in a single server process and interact with that server from client processes\n\nthe server should have these rpcs:\n\n- do(todoID): jobID\n- kill(jobID)\n- tail(jobID): <-Event # all so far + new ones as they come\n- logs(jobID): []Event # so far\n- list(): []Job\n\nuse json-over-http for rpcs\n\n(pass through to the log stuff from the job package)\n\nthe subcommand should have these verbs:\n\n- ii swarm serve --addr=\n- ii swarm do ['job do' flags], --path= --addr= -- does the rpc, then does tail and and streams the logs to stdout; on sigint-or-whatever, stop tailing but the job keeps running in the server process; path is required; creates the todo on the client side before doing the rpc with just the todo ID\n- ii swarm kill <jobid>\n- ii swarm tail <jobid> -- shares code with 'do'\n- ii swarm logs <jobid>\n- ii swarm list -- active jobs only by default, like other lists\n\nport from cli flag > port from .incrementum/config.toml > standard default port\n\n","status":"done","priority":3,"type":"task","created_at":"2026-01-24T03:00:57.887861-06:00","updated_at":"2026-01-24T11:24:36.20428-06:00","closed_at":"2026-01-24T11:24:36.20428-06:00","started_at":"2026-01-24T10:44:40.377525-06:00","completed_at":"2026-01-24T11:24:36.20428-06:00"}
{"id":"u4axync5","title":"'ii job' should have the same log-related subcommands as 'ii opencode'","description":"except: this is a combined event stream across the whole sequence of opencode sessions, review files, etc etc; we should use opencode's event structure but add our own events\n\nwe materialize these to disk as jsonl files in ~/.local/share/incrementum/jobs/events/<job_id.jsonl>\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T03:02:59.32004-06:00","updated_at":"2026-01-24T06:36:12.849296-06:00","closed_at":"2026-01-24T06:36:12.849296-06:00"}
{"id":"wrmfm765","title":"information architecture in commit messages and in stdout logs","description":"'ii job do's logs and also our generated commit messages both combine many\ndocuments of several types into a single stream. right now, it's hard to tell\nwhere one section ends and the next begins.\n\nwe should make the information hierarchy clearer using precise indentation and\nreflow: intradocument content should be 80c wide and indented 0c, documents\nshould be 76c wide and indented 4c, subdocuments should be 72c wide and\nindented 8c, etc\n\nWe should reflow properly; use muesli/reflow.\n\nCommit messages should look like this (note that I've removed the full opencode\ntranscripts; those weren't actually helpful). We should not use text/template\nto generate commit messages; it doesn't make sense to customize them:\n\n```\nFirst line of generated commit message\n\nHere is a generated commit message:\n\n    Subsequent lines of generated commit message reflowing onto second and\n    third lines as necessary, etc etc etc\n\nThis commit is a step towards implementing this todo:\n\n    The todo, indented 4c\n```\n\nLogs should look like this:\n\n```\nDoing job abc123\nRunning implementation prompt:\n    Implementation prompt:\n        [Entire implementation prompt, indented 4c]\n    Opencode transcript:\n        [Opencode transcript, indented 8c]\nImplementation prompt complete; running tests:\n    [`go test` output, indented 4c]\nTests passed; doing code review:\n     Code review prompt:\n         [Code review prompt]\n     Code review result:\n         [Code review result]\n...etc\n```\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T03:52:59.911339-06:00","updated_at":"2026-01-24T09:34:25.211444-06:00","closed_at":"2026-01-24T09:34:25.211444-06:00"}
{"id":"5v6cgsev","title":"jj description from stdin","description":"whenever we jj commit or jj describe, we should pass the description to stdin instead of as a flag; we get args-too-long errors. see jj describe --help to confirm how to set the description flag to make it read from stdin\n\njj commit doesn't support the stdin flag, but jj describe does. jj commit is equivalent to jj describe followed by jj new. make sure that this is tested by running with the real jj describe command and observing the commit message\n","status":"done","priority":1,"type":"task","created_at":"2026-01-24T05:01:22.109475-06:00","updated_at":"2026-01-24T05:40:13.328565-06:00","closed_at":"2026-01-24T05:40:13.328565-06:00"}
{"id":"2wnlduml","title":"new policy: never mock","description":"policy: never mock; when we gave code that shells out, make sure we test the real integration; we should always test that third-party binaries we use do the things we expect.\n\nput this guidance in a new \"architecture\" section at the top of specs/README.md. Move other architectural guidance (like in AGENTS.md and in specs/cli.md) to that new section.\n\naudit all test files to ensure they follow this guidance.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T05:35:24.101869-06:00","updated_at":"2026-01-24T10:18:07.008328-06:00","closed_at":"2026-01-24T10:18:07.008328-06:00"}
{"id":"myks4hcq","title":"Fix job testscript opencode connection failure","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-24T06:06:35.035983-06:00","updated_at":"2026-01-24T10:26:40.619336-06:00","closed_at":"2026-01-24T10:26:40.619336-06:00"}
{"id":"e6xypbrx","title":"track todo duration","description":"- add startedAt and completedAt fields\n- set startedAt when a todo enters in_progress, reset on any status change except to 'done'\n- set completedAt on status change from in_progress to done\n- show duration in list for in_progress (now-start) and done (completed-start) todos\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T06:36:29.552702-06:00","updated_at":"2026-01-24T10:35:29.425283-06:00","closed_at":"2026-01-24T10:35:29.425283-06:00"}
{"id":"6l6mfpto","title":"make 'todo edit' an alias for 'todo update'","description":"preferably it doesn't get its own like in help\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T06:38:34.587549-06:00","updated_at":"2026-01-24T10:37:29.819982-06:00","closed_at":"2026-01-24T10:37:29.819982-06:00","started_at":"2026-01-24T10:35:31.870249-06:00","completed_at":"2026-01-24T10:37:29.819982-06:00"}
{"id":"466cgohq","title":"we should always launch opencode via the opencode package","description":"look for anywhere we're shelling out to opencode, and make it use the opencode package instead. the shared wrapper adds important logging and state tracking.\n","status":"done","priority":1,"type":"task","created_at":"2026-01-24T06:40:56.602508-06:00","updated_at":"2026-01-24T08:19:05.247824-06:00","closed_at":"2026-01-24T08:19:05.247824-06:00"}
{"id":"gvznvjzz","title":"make sure we always use jj via the internal package","description":"we should never shell out directly; we should only access jj via our internal jujutsu wrapper package\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T06:41:48.563019-06:00","updated_at":"2026-01-24T10:41:40.382085-06:00","closed_at":"2026-01-24T10:41:40.382085-06:00","started_at":"2026-01-24T10:37:32.080349-06:00","completed_at":"2026-01-24T10:41:40.382085-06:00"}
{"id":"f2zuru5y","title":"use stdin for opencode run prompt, not arg","description":"we're getting \"args too long\" errors\n\nfind everywhere we shell out to opencode run (should only be the opencode package; unify if not) and pass the prompt as stdin instead of arguments. this works out of the box: if opencode run gets stdin and no non-flag positional arguments, it reads the prompt from stdin.\n","status":"done","priority":0,"type":"task","created_at":"2026-01-24T08:06:05.070783-06:00","updated_at":"2026-01-24T08:15:29.780293-06:00","closed_at":"2026-01-24T08:15:29.780293-06:00"}
{"id":"dkyx3sva","title":"clean up","description":"look for code cleanup opportunities, but do not change cli behavior (changing\nhow things are printed is fine, but invocations that did something before\nshould still do that thing after)\n\n- is there duplicated code?\n- is the domain model clear and well-factored?\n- is there needless inconsistency?\n- are things in the right places?\n- is error handling consistent and robust?\n- are we doing things that are not necessary?\n","status":"done","priority":4,"type":"task","created_at":"2026-01-24T08:21:38.103939-06:00","updated_at":"2026-01-28T13:07:48.762877-06:00","closed_at":"2026-01-28T13:07:48.762877-06:00"}
{"id":"zrvth6i6","title":"Fix job test opencode stub to read prompt stdin","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-24T08:33:36.795328-06:00","updated_at":"2026-01-24T10:44:38.887092-06:00","closed_at":"2026-01-24T10:44:38.887092-06:00","started_at":"2026-01-24T10:41:42.911675-06:00","completed_at":"2026-01-24T10:44:38.887092-06:00"}
{"id":"bfvacl4o","title":"'ii swarm do' needs to accept a todoid positional argument","description":"'ii swarm do' should take more or less the same exact flags and arguments as\n'ii job do', with the same $EDITOR behavior\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T22:29:54.930501-06:00","updated_at":"2026-01-24T22:40:49.875231-06:00","closed_at":"2026-01-24T22:40:49.875231-06:00","started_at":"2026-01-24T22:30:01.331697-06:00","completed_at":"2026-01-24T22:40:49.875231-06:00"}
{"id":"43ortb3l","title":"opencode stdout/stderr should be indented","description":"- capture and indent\n- don't try to reflow; long line lengths are fine here\n- put a heading above (like usual)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T22:33:21.987828-06:00","updated_at":"2026-01-25T01:06:28.096921-06:00","closed_at":"2026-01-25T01:06:28.096921-06:00","started_at":"2026-01-25T00:58:47.017048-06:00","completed_at":"2026-01-25T01:06:28.096921-06:00"}
{"id":"n7uzw56q","title":"better log for tests","description":"```current log output\nImplementation prompt complete; running tests:\n    -\n\nTests passed; doing code review:\n```\n\n^ not good; we should capture and indent the actual test output\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T22:40:15.373012-06:00","updated_at":"2026-01-25T01:29:40.926475-06:00","closed_at":"2026-01-25T01:29:40.926475-06:00","started_at":"2026-01-25T01:06:30.761516-06:00","completed_at":"2026-01-25T01:29:40.926475-06:00"}
{"id":"hmdf44bm","title":"'ii job list' and 'ii swarm list' should show the todo title in the table","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-24T22:41:12.696982-06:00","updated_at":"2026-01-25T01:35:47.659671-06:00","closed_at":"2026-01-25T01:35:47.659671-06:00","started_at":"2026-01-25T01:29:44.201197-06:00","completed_at":"2026-01-25T01:35:47.659671-06:00"}
{"id":"upr2ihlm","title":"fix jj behavior in swarm do","description":"    > ii swarm do 43\n    Error: swarm error: acquire workspace: jj edit: jj edit: exit status 1: Error: Commit c5bfdc832a22 is immutable\n    Hint: Could not modify commit: oknplymx c5bfdc83 main | Reuse shared test log table formatter\n    Hint: Immutable commits are used to protect shared history.\n\nc5bfdc832a22 has the 'main' bookmark, so, yeah, we shouldn't be trying to edit it.\n\nwe should do something like (pseudocode)\n\n    new_commit=$(jj new main --no-edit) # creates a new commit with main as the parent; logs the commit it created\n    workspace.Acquire(new_commit)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T22:48:13.048564-06:00","updated_at":"2026-01-24T23:15:37.424256-06:00","closed_at":"2026-01-24T23:15:37.424256-06:00","started_at":"2026-01-24T22:48:22.043247-06:00","completed_at":"2026-01-24T23:15:37.424256-06:00"}
{"id":"3rm7wgj5","title":"reflowing prose doesn't respect markdown","description":"here are some things we reflow that are markdown:\n\n- prompts\n- todo descriptions\n\nin both cases, naive reflowing will break (eg) markdown lists and codeblocks\n\nwe should use a proper markdown renderer; add charmbracelet/glamour (which is\nchecked out to ~/Work/glamour so you can read source/docs)\n","status":"done","priority":0,"type":"task","created_at":"2026-01-24T22:51:05.814305-06:00","updated_at":"2026-01-25T00:58:45.131325-06:00","closed_at":"2026-01-25T00:58:45.131325-06:00","started_at":"2026-01-25T00:24:57.413917-06:00","completed_at":"2026-01-25T00:58:45.131325-06:00"}
{"id":"gperim6j","title":"in 'jj swarm do', our new change is garbage collected before we can edit it","description":"we do something like this:\n\ncommit=$(jj new main --no-edit)\n\nii workspace acquire $commit\n\nexcept empty commits are garbage collected when we do operations, which 'workspace acquire' does before actually checking out the workspace, so this is no good\n\nlet's add a description to the new commit we create: `jj new main --no-edit --message=\"staging for todo $todo_id\"`\n","status":"done","priority":2,"type":"task","created_at":"2026-01-24T23:29:02.985567-06:00","updated_at":"2026-01-24T23:41:38.273714-06:00","closed_at":"2026-01-24T23:41:38.273714-06:00","started_at":"2026-01-24T23:29:12.363114-06:00","completed_at":"2026-01-24T23:41:38.273714-06:00"}
{"id":"5adjhq6n","title":"'jj edit' called on commit created with 'jj new root()'","description":"Error: swarm error: acquire workspace: jj edit: jj edit: exit status 1: Error: Revision `yklrxptzomtpntymtrlxrmzyrkxllovp` doesn't exist\n\nthat revision was created in a previous op via 'jj new root()'\n\n'jj new $base' creates an _empty change_ and also checks it out in the current jj workspace to it\n\n'jj edit $changeid' moves the current directory to an existing change\n\nempty changes are garbage collected immediately if they are not checked out in any jj workspace\n\n'jj new root()' is a thing we do sometimes to move the current workspace off of any change that would be modified by another workspace, preventing conflicts\n\nbut to 'jj edit' a change that was created by 'jj new root()' never makes sense; wherever we're doing that, we're doing it incorrectly\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T00:02:03.687513-06:00","updated_at":"2026-01-25T00:22:36.170378-06:00","closed_at":"2026-01-25T00:22:36.170378-06:00","started_at":"2026-01-25T00:02:10.377303-06:00","completed_at":"2026-01-25T00:22:36.170378-06:00"}
{"id":"uzrnzsae","title":"machine-made todos should be reviewed","description":"i encourage our opencode agents to create todos, but i want to subject those to human review before acting on them\n\nlet's add a new todo status, \"proposed\"\n\nproposed todos should appear by default (alongside open and in-progress todos) in todo list\n\nby default, new todos created at the command line (and the template loaded into $EDITOR) are \"open\"\n\nbut if the INCREMENTUM_TODO_PROPOSER var is \"true\", the default should be \"proposed\"\n\nand then let's set that var whenever we invoke opencode (which should only be via the opencode package; fix if not)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T01:02:05.883225-06:00","updated_at":"2026-01-25T01:50:49.131391-06:00","closed_at":"2026-01-25T01:50:49.131391-06:00","started_at":"2026-01-25T01:35:49.48488-06:00","completed_at":"2026-01-25T01:50:49.131391-06:00"}
{"id":"sra2cthm","title":"tui for ii swarm","description":"let's add a tui (with charmbracelet/bubbletea, which is checked out to ~/Work/bubbletea so you can see source/docs).\n\nthe tui is a client to the swarm server. i can invoke it with `ii swarm client`.\n\nwe can add rpcs to the server if we need to, but they should be aligned with our existing cli and go apis.\n\nthe tui has two tabs: todo and jobs\n\neach tab has a scrolling list pane on the left and a bigger detail pane on the right. i navigate to a todo/job in the list, and its details are shown in the detail pane. i can press enter to move focus to the detail pain, then esc to move focus back out to the list pane.\n\nspecific to the todo tab: from the list pane, i can press c to create a todo. when the detail pane is selected, i can tab between the fields of the todo and edit them. from list pane, i can press s and then confirm in a popup modal to start a job in the swarm for the given todo.\n\nspecific to the jobs tab: shows a list of the jobs running in the swarm. the detail pane is its event log, printed nicely.\n\nthe first steps are to work this into a reasonable spec, drawing the rest of the owl. the next steps are to implement the tui.\n","status":"done","priority":3,"type":"task","created_at":"2026-01-25T01:29:40.252663-06:00","updated_at":"2026-01-25T02:54:11.681832-06:00","closed_at":"2026-01-25T02:54:11.681832-06:00","started_at":"2026-01-25T01:57:29.314559-06:00","completed_at":"2026-01-25T02:54:11.681832-06:00"}
{"id":"blefcs2a","title":"audit for avoidance of abstractions","description":"one place where we can accidentally leak our abstractions is the state file: because it is public, and because its state supports many packages, it is easy for some caller to mistakenly load the todo state from the state file directly rather than going through the todo package. this is bad practice, since it routes around whatever extra logic the getters in the todo package might now or someday perform.\n\nfix any instances of this.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T01:38:29.307387-06:00","updated_at":"2026-01-25T01:57:27.831211-06:00","closed_at":"2026-01-25T01:57:27.831211-06:00","started_at":"2026-01-25T01:50:50.675589-06:00","completed_at":"2026-01-25T01:57:27.831211-06:00"}
{"id":"j54rt74q","title":"add web client for ii swarm serve","description":"ii swarm serve should have a web client, with basically the same affordances as the tui client. in the spirit of doing what go is good at (and of testability) let's make the web client a templating http server with no javascript requirement. when run, the server should make rpcs to the swarm to populate some in-memory state, then respond to requests by building pages. use only the standard library. put it in a ./web package.\n\nthe first steps here are to build out a spec for this featureset (draw the rest of the owl)\n\nsubsequent steps are to implement and test.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T01:48:24.025981-06:00","updated_at":"2026-01-25T03:28:39.463111-06:00","closed_at":"2026-01-25T03:28:39.463111-06:00","started_at":"2026-01-25T02:54:14.439585-06:00","completed_at":"2026-01-25T03:28:39.463111-06:00"}
{"id":"arlpicg2","title":"Investigate swarm tail test timeout","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-25T02:04:57.58782-06:00","updated_at":"2026-01-25T03:48:17.005312-06:00","deleted_at":"2026-01-25T03:48:17.00361-06:00"}
{"id":"l2hl2g6n","title":"bug: not glamour-rendering prompts","description":"from logs:\n\n    Review the changes: - Does it do what the message says? - Does it move us\n    towards the goal in the todo? - Is it _necessary_ for moving us towards\n    the goal in the todo? - Is it free of defects? - Is the domain modeling\n    coherent and sound? - Are things in the right place? - Does it include\n    proper test coverage? - Does it keep the relevant specs up to date? - Does\n    it conform to the norms of the code areas it modifies? - Does it work?\n\nI believe this was written as a markdown unordered list, but it looks like\nwe're reflowing it incorrectly--I see the list-item dashes inline. We should\nuse the glamour markdown renderer\n\nWe may already have a good internal package wrapping glamour? if not, we\nshould, and we should use it everywhere we render prose text to the screen.\nthis seems like a reasonable api:\n\n    markdown.Render(width, indent int, input []byte) []byte\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-25T03:17:39.791963-06:00","updated_at":"2026-01-25T03:44:08.34427-06:00","closed_at":"2026-01-25T03:44:08.34427-06:00","started_at":"2026-01-25T03:28:47.276783-06:00","completed_at":"2026-01-25T03:44:08.34427-06:00"}
{"id":"2z6kn6r3","title":"swarm serve should log the hostname and port number","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-25T04:24:17.779266-06:00","updated_at":"2026-01-25T04:32:21.068115-06:00","closed_at":"2026-01-25T04:32:21.068115-06:00","started_at":"2026-01-25T04:29:16.343813-06:00","completed_at":"2026-01-25T04:32:21.068115-06:00"}
{"id":"c3en45cq","title":"fix tui","description":"the tui isn't great:\n\n- I can't change my todo selection with the arrow keys or j/k\n- I can't switch tabs (or if I can, nothing tells me how)\n- I can't even see the tab bar\n\nfind a better way to test for rendering bugs; it might be useful to have \"screencap\" text files on disk\n\nadd affordances that reveal each key shortcut -- this could be a help menu (and text to the effect of \"press ? to open help\") or it could be including the keys on the widgets they activate, like \"[1] todos\" or whatever\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T04:29:04.251089-06:00","updated_at":"2026-01-25T04:47:12.811659-06:00","closed_at":"2026-01-25T04:47:12.811659-06:00","started_at":"2026-01-25T04:32:23.734801-06:00","completed_at":"2026-01-25T04:47:12.811659-06:00"}
{"id":"vkxxciij","title":"swarm serve log","description":"instead of printing host and port separately, let's just print the full addr","status":"done","priority":2,"type":"task","created_at":"2026-01-25T04:59:59.130857-06:00","updated_at":"2026-01-25T05:20:46.863742-06:00","closed_at":"2026-01-25T05:20:46.863742-06:00"}
{"id":"gqm2s2io","title":"audit event pipeline","description":"make sure this is all set up and working:\n\nthe opencode package collects events (by subscribing to the sse endpoint), and both logs them to disk and sends them to its caller via a go channel. it also supports reading its events from disk with a 'logs' command/method.\n\nthe job package calls the opencode package, receives those events, merges them into a combined stream with its own events (since jobs span more than a single opencode session), and both logs them to disk and sends them to its caller via a go channel and, in the case of the job cli, renders them nicely and prints them to stdout. it also supports reading its events from disk with a 'logs' command/method.\n\nthe swarm package calls the job package, receives those events, and streams them out to clients like (for example) the tui and web\n\nclients like the tui and web subscribe to the event stream for each job, receive each event, and render them to their ui.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T05:06:58.304947-06:00","updated_at":"2026-01-25T05:35:35.468576-06:00","closed_at":"2026-01-25T05:35:35.468576-06:00","started_at":"2026-01-25T05:20:53.616951-06:00","completed_at":"2026-01-25T05:35:35.468576-06:00"}
{"id":"ceo3xfmg","title":"audit swarm serve error handling","description":"i got into a weird state:\n\n- in one tab i ran 'ii swarm serve'\n- from the web client, I kicked off a job in the swarm\n- a while later, the job was marked 'failed' (unclear why) and the server started giving me \"Post \"http://127.0.0.1:8088/do\": dial tcp 127.0.0.1:8088: connect: connection refused\"\n- but it hadn't logged any errors or anything, about either the failed job or about the listener dying-or-whatever\n\nmake the swarm package and its cli wrapper more robust; handle errors properly; log consistently. make it easy to operate and debug.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T05:10:45.593001-06:00","updated_at":"2026-01-25T05:57:36.040721-06:00","closed_at":"2026-01-25T05:57:36.040721-06:00"}
{"id":"thpmn4dm","title":"perf audit","description":"use go's wonderful profiling tooling to explore and improve the performance of our system here\n\n- pick an operation (like 'ii todo list')\n- benchmark it, running with abundant generated test data\n- profile\n- make an improvement\n- benchmark again to show improvement\n- include both benchmarks in your commit message\n\ndon't be afraid to build tooling for benchmarking, generating test data, or whatever else\n\nkeep ./specs/perf.md updated with current understanding, a log of improvements made, measurements, tool-use instructions, whatever's useful.\n","status":"done","priority":4,"type":"task","created_at":"2026-01-25T05:15:04.559138-06:00","updated_at":"2026-01-28T13:07:48.762877-06:00","closed_at":"2026-01-28T13:07:48.762877-06:00"}
{"id":"o2nlpsfy","title":"busted wrapping in 'Final commit message:' log","description":"I see this log:\n\n```log\nReview complete; committing changes:\n    Final commit message:\n\n          job: stream job event logs to callers\n\n          Here is a generated commit message:\n\n              [incorrectly wrapped commit message]\n\n          This commit is a step towards implementing this todo:\n\n            ID: gqm2s2io\n            Title: audit event pipeline\n            Type: task\n            Priority: 2 (medium)\n            Description:\n\n                  [correctly wrapped todo description]\n```\n\nbut I see _this_ commit message in my actual vcs:\n\n```commit\njob: stream job event logs to callers\n\nHere is a generated commit message:\n\n    [correctly wrapped commit message]\n\nThis commit is a step towards implementing this todo:\n\n    ID: gqm2s2io\n    Title: audit event pipeline\n    Type: task\n    Priority: 2 (medium)\n    Description:\n\n          [correctly wrapped todo description]\n```\n\nthe todo description text is wrapped correctly in both place\n\nthe generated commit message text is wrapped correctly in the actual commit message, but wrapped incorrectly in the job log\n\nfix the wrapping: we should _always_ be using glamour (internal/markdown) to reflow and indent text, and we must be diligent tracking indent levels and available width\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-25T05:36:40.711883-06:00","updated_at":"2026-01-25T06:39:48.671599-06:00","closed_at":"2026-01-25T06:39:48.671599-06:00","started_at":"2026-01-25T06:16:14.475674-06:00","completed_at":"2026-01-25T06:39:48.671599-06:00"}
{"id":"bkfjawu5","title":"'ii job do' shouldn't send opencode logs directly to stdout","description":"while 'ii job do' is running, I _don't_ want to see opencode's stdout/stderr\n\nI _do_ however, want to see the events we stream in from opencode rendered and indented properly for our logging context\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T05:38:09.431163-06:00","updated_at":"2026-01-25T07:11:44.13461-06:00","closed_at":"2026-01-25T07:11:44.13461-06:00","started_at":"2026-01-25T06:47:45.147605-06:00","completed_at":"2026-01-25T07:11:44.13461-06:00"}
{"id":"f6lzv3tv","title":"add 'agent' flag to opencode","description":"the opencode package should take an 'agent' string argument, which is unset/empty by default\n\nif it's passed, we include `--agent=%s` in our shell-out to opencode\n\nthis should be exposed as a command line flag\n\npackages which themselves call opencode should expose this option and pass it through\n\nprecedence order: flag > INCREMENTUM_OPENCODE_AGENT > empty string\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T06:11:47.838517-06:00","updated_at":"2026-01-25T07:20:34.585491-06:00","closed_at":"2026-01-25T07:20:34.585491-06:00","started_at":"2026-01-25T07:11:47.185756-06:00","completed_at":"2026-01-25T07:20:34.585491-06:00"}
{"id":"uuf5wdc7","title":"commit message leading newlines","description":"ever since the commit `jj show yynltqwu`, our commit messages begin with two empty lines, and the first line with text also has a ton of trailing whitespace\n\nthis makes the summary line not show up in `jj log`, which is bad\n\nfix the code that does this so that we start producing valid commit messages\n\nwe tried to fix this in `jj show vxzpomqq`, but it didn't work: we continued to produce commit messages that began with two empty lines and did not appear in `jj log`.\n\nwe tried to fix this again in `jj show slwxuvlp`, but it didn't work either.\n\ninspect these fixes and come up with a theory-of-mind for why the author thought they would work, why they were actually incorrect, and why _your_ solution _will_ work.\n\nprove that the solution works with testing that observes an actual `ii job run` in an actual jj repo and actually inspects the actual jj log result\n\nfigure out where these newlines are being inserted -- is the agent writing them to the commit message file? is it a templating artifact? something else? and fix the problem at the root.\n\neach commit message to address this must include a detailed explanation of the mechanism that was at play here, and proof that _that mechanism_ was the one that caused the problem.\n\neach commit message to address this must also include a description of the theory-of-mind described above.\n","status":"done","priority":0,"type":"task","created_at":"2026-01-25T12:00:00.167442-06:00","updated_at":"2026-01-25T15:12:49.43912-06:00","closed_at":"2026-01-25T15:12:49.43912-06:00","started_at":"2026-01-25T14:27:21.023383-06:00","completed_at":"2026-01-25T15:12:49.43912-06:00"}
{"id":"atpvdmt3","title":"fix tui ui","description":"- i need to see on-screen documentation that says what keyboard actions are available\n- I when the detail pane is selected, I need to be able to 'tab' between fields of the todo\n- all todos should be editable when I'm looking at them in the detail pane; this _is_ an editor\n- I need an affordance (documented onscreen) that says how to submit a todo to the swarm\n- the top visible line is the blue block that says \"Todos\" (on the left) and the word \"Editable\" (on the right). Is that intentional? I feel like I should at least be seeing the top borders of the little boxes, if not a tab bar above that.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T12:09:53.153533-06:00","updated_at":"2026-01-25T13:16:08.144324-06:00","closed_at":"2026-01-25T13:16:08.144324-06:00","started_at":"2026-01-25T13:02:31.074326-06:00","completed_at":"2026-01-25T13:16:08.144324-06:00"}
{"id":"jjok52cw","title":"swarm tui/webui should emphasize open todos","description":"show:\n\n- 'proposed' todos\n- then 'open' todos\n- then, grayed out, 'done' todos\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T12:11:06.919623-06:00","updated_at":"2026-01-25T13:23:32.127841-06:00","closed_at":"2026-01-25T13:23:32.127841-06:00","started_at":"2026-01-25T13:16:11.156742-06:00","completed_at":"2026-01-25T13:23:32.127841-06:00"}
{"id":"pzp4jtpj","title":"ii swarm jobs always fail with 'opencode session not found'","description":"where do we log this? what does it mean for an opencode session to be 'not found'?\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T12:21:04.83713-06:00","updated_at":"2026-01-25T13:43:22.094495-06:00","closed_at":"2026-01-25T13:43:22.094495-06:00","started_at":"2026-01-25T13:23:35.312836-06:00","completed_at":"2026-01-25T13:43:22.094495-06:00"}
{"id":"ahs35yj3","title":"ii swarm tail not working","description":"i never see output on 'ii swarm tail <todoid>', even if refreshing the webui shows that there are new events being created for that todoid\n\naudit this code path\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-25T12:21:40.468614-06:00","updated_at":"2026-01-25T12:59:00.98564-06:00","closed_at":"2026-01-25T12:59:00.98564-06:00","started_at":"2026-01-25T12:29:50.906935-06:00","completed_at":"2026-01-25T12:59:00.98564-06:00"}
{"id":"fbe7mirs","title":"ctrl-c-ing the swarm server should fail its jobs","description":"we're leaking jobs in the 'implementing' stage and the 'active' status when I kill the server; we should clean these up in the signal-handling exit path\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T12:23:09.684277-06:00","updated_at":"2026-01-25T16:08:07.300905-06:00","closed_at":"2026-01-25T16:08:07.300905-06:00","started_at":"2026-01-25T15:58:41.314251-06:00","completed_at":"2026-01-25T16:08:07.300905-06:00"}
{"id":"kl7p76p3","title":"simplify workspaces","description":"right now, it's incumbent on the caller to create an empty jj change and then pass it into 'ii workspace acquire' (or the go library)\n\nthat's tricky, because empty jj changes are vigorously garbage collected\n\ninstead, once we've chosen a workspace folder, we should run 'jj new $($rev ?? main)' in it so that it is checked out to a new change based on the provided rev (or main)\n\nwe may have to update the code that calls the workspace package\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T12:29:30.795316-06:00","updated_at":"2026-01-25T16:21:22.548151-06:00","closed_at":"2026-01-25T16:21:22.548151-06:00","started_at":"2026-01-25T16:08:10.58513-06:00","completed_at":"2026-01-25T16:21:22.548151-06:00"}
{"id":"26lnccaq","title":"log opencode events smarter","description":"we should still capture the full json events, but:\nwhen we display them (eg to stdout or in the web or tui) we should be a bit more circumspect about how they're rendered -- json blobs are hard to read\n\nexplore the logs we have on disk and come up with a list of the event types\n\nwe probably don't want to display all of them, and we certainly don't want to display all their detail\n\nI'm interested in:\n\n- tool calls, which we can log in one line after they're complete, like, \"read file '%filepath'\" or \"edit file '%filepath'\"\n- prompt text we send to the agent\n- text responses from the agent\n- 'thinking' text from the agent\n\nwe should have a switch per-event-type, and then little (html _and_ width-aware text) renderers for that event type\n\nimplementation details (and everything we learn from the on-disk log exploration) should go in a spec 'events.md'\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T12:38:13.885178-06:00","updated_at":"2026-01-25T16:41:45.978461-06:00","closed_at":"2026-01-25T16:41:45.978461-06:00","started_at":"2026-01-25T16:21:26.474075-06:00","completed_at":"2026-01-25T16:41:45.978461-06:00"}
{"id":"dzhzwe7n","title":"real-world end-to-end testing","description":"we should have tests that:\n\n- create a real jj repo\n- create some existing commits\n- put the 'main' bookmark somewhere plausible\n- use the todo cli to create todos\n- use the job cli to complete todos\n- examine the jj repo, the changes on disk, the todo state, etc\n\nwe should have more tests that:\n\n- create a real jj repo\n- create some existing commits\n- put the 'main' bookmark somewhere plausible\n- use the todo cli to create multiple todos\n- use the swarm cli to start a server\n- use the swarm cli to complete multiple todos in parallel\n- examine the jj repo, the changes on disk, the todo state, etc\n\na trick here is that the agents are a bit non-deterministic, so we'll have to give them very specific instructions. stuff like 'execute 'echo \"hello world\" > hello-world.txt'; take no other action'\n\nthere should be a spec testing.md that describes our tiered approach to testing, with unit tests, integration tests, realistic e2e tests; our use of testscript/txtar; the supporting utilities we use; etc\n\nwe should add a section to specs/README.md called something like \"development practices\" or \"architecture\" or something with this spec and others like it that aren't about a specific package\n","status":"done","priority":1,"type":"task","created_at":"2026-01-25T13:33:47.834582-06:00","updated_at":"2026-01-25T15:58:39.325686-06:00","closed_at":"2026-01-25T15:58:39.325686-06:00","started_at":"2026-01-25T15:37:44.48122-06:00","completed_at":"2026-01-25T15:58:39.325686-06:00"}
{"id":"njxge6f4","title":"include 'agent' in job state/history","description":"we should add an 'agent' field to jobs, and populate it with the agent that opencode was run with (or the empty string if no agent was passed)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T14:15:53.180657-06:00","updated_at":"2026-01-25T16:54:17.188382-06:00","closed_at":"2026-01-25T16:54:17.188382-06:00","started_at":"2026-01-25T16:41:49.759754-06:00","completed_at":"2026-01-25T16:54:17.188382-06:00"}
{"id":"h7iqkssd","title":"make diff check more robust","description":"our current diff check (\"workspace changed from %s to %s\") relies on commit ids, but those can sometimes change even if nothing salient was modified (example: someone else changed the commit message of some ancestor, causing a rehash)\n\nwe should still start with that as an initial check, but then if there is a change, we should follow up with \"jj diff --from %s --to %s --stat\" or similar to confirm that the change is real\n\nthe current failure mode is:\n\n- the agent makes no changes\n- the commit hash changes for some unrelated reason\n- we error 'commit message missing after opencode implementation', but in fact no commit message is expected since no change was made\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T14:19:52.2692-06:00","updated_at":"2026-01-25T17:04:32.883433-06:00","closed_at":"2026-01-25T17:04:32.883433-06:00","started_at":"2026-01-25T16:58:32.836256-06:00","completed_at":"2026-01-25T17:04:32.883433-06:00"}
{"id":"q6ottpvu","title":"add -version flag","description":"add a -version flag to ii, which prints the jj change id and commit id from when ii was built (we don't do version numbers)\n\ninsert those values with ldflags; add that to ./bin/ii and also a new build-and-install script ./bin/install\n","status":"done","priority":3,"type":"task","created_at":"2026-01-25T14:27:16.578425-06:00","updated_at":"2026-01-25T17:17:13.123438-06:00","closed_at":"2026-01-25T17:17:13.123438-06:00","started_at":"2026-01-25T17:04:36.736889-06:00","completed_at":"2026-01-25T17:17:13.123438-06:00"}
{"id":"cwyo6drw","title":"Job testscript opencode stub expects Workspace root","description":"","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-25T14:44:19.953156-06:00","updated_at":"2026-01-25T15:36:46.453958-06:00","deleted_at":"2026-01-25T15:36:46.452873-06:00"}
{"id":"mhajvx7t","title":"opencode prompt not being markdown-formatted","description":"I'm looking at `ii job do` logs. The top-level section is \"Running implementation prompt:\". The subsection is \"Opencode prompt:\". What I see is the markdown prompt, but with its unordered list fully inlined: it looks like we're reflowing it improperly: one item ends, and then I see a `-` character and the next item without a preceeding newline. I see the same thing within the `<todo>` block.\n\nWe should be formatting these with glamour, via our internal/markdown package.\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-25T16:48:17.969569-06:00","updated_at":"2026-01-25T16:58:29.078834-06:00","closed_at":"2026-01-25T16:58:29.078834-06:00","started_at":"2026-01-25T16:54:21.117375-06:00","completed_at":"2026-01-25T16:58:29.078834-06:00"}
{"id":"yczfgm5t","title":"get rid of fake-xml in prompts","description":"glamour (our markdown renderer) strips our fake xml tags (eg: `<todo>`) from prompts.\n\nthis is fine and good, whatever.\n\nbut it means that instead of using fake xml tags, we need some other affordance to label verbatim prompt sections.\n\nlet's use our standard heading-and-indent approach.\n\nI should see something like `Todo\\n\\n    Content of todo, wrapped to 76c`\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T17:09:50.109381-06:00","updated_at":"2026-01-25T17:36:25.264513-06:00","closed_at":"2026-01-25T17:36:25.264513-06:00","started_at":"2026-01-25T17:22:36.686489-06:00","completed_at":"2026-01-25T17:36:25.264513-06:00"}
{"id":"57uzut5r","title":"snapshot-test text formatting","description":"add snapshot tests of our large blocks of formatted text:\n\n- each prompt (including injected markdown todos, prev commit messages, etc)\n- commit messages (including the injected todos, etc)\n- job logs? do we have any long-form ones of these? maybe not\n\neach snapshot should exercise as much of the text generation pipeline as is feasible without actually running opencode or making a repo, and should exercise (in particular) line-wrapping edge cases--long lines, paragraphs, bullets, code blocks, etc. You might need to refactor the text generation stuff to make it more testable (or maybe you won't, idk).\n\nwe don't need an auto-generation mechanism; the exercise of manually\nbookkeeping the files should be helpful here\n\n(also add info about this to the testing spec)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-25T22:35:26.177668-06:00","updated_at":"2026-01-25T23:08:46.408682-06:00","closed_at":"2026-01-25T23:08:46.408682-06:00","started_at":"2026-01-25T22:36:10.537332-06:00","completed_at":"2026-01-25T23:08:46.408682-06:00"}
{"id":"w2k6jqwt","title":"Fix readEventLog test helper mismatch","description":"When running Go tests in package job, compilation fails because readEventLog now returns two values and takes EventLogOptions plus a bool, but several tests still call the old signature.\n\nUpdate the test helper/call sites to match the new signature, or reintroduce a test-only wrapper if needed.\n\nFailing locations:\n- job/events_test.go:32 and job/events_test.go:121\n- job/logging_test.go:440\n- job/runner_test.go:639","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-25T22:56:15.118338-06:00","updated_at":"2026-01-25T23:56:05.69984-06:00","deleted_at":"2026-01-25T23:56:05.698668-06:00"}
{"id":"ruz2muli","title":"Fix job test helper name collision","description":"Go test ./job fails to compile because job/events_test.go defines readEventLog in package job, which conflicts with readEventLog in job/events.go.\n\nSymptoms:\n- go test ./job reports redeclared readEventLog and mismatched call signatures in events_test.go, logging_test.go, runner_test.go.\n\nSuggested fixes:\n- Rename the test helper (e.g. readEventLogFile) or move tests to package job_test and use exported APIs.\n- Update helper call sites accordingly.\n\nImpact:\n- Prevents running job package tests, including log snapshot tests.","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-25T23:03:58.729357-06:00","updated_at":"2026-01-25T23:56:05.69984-06:00","deleted_at":"2026-01-25T23:56:05.698668-06:00"}
{"id":"wt5dp4nd","title":"fix the failing tests","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-25T23:56:15.496899-06:00","updated_at":"2026-01-26T23:56:14.055759-06:00","closed_at":"2026-01-26T23:56:14.055759-06:00","started_at":"2026-01-26T23:15:23.033384-06:00","completed_at":"2026-01-26T23:56:14.055759-06:00"}
{"id":"b7dewhbx","title":"log when tools start, not just when they end","description":"some tool calls take a long time. right now, it just looks like we're hanging. we should log \"tool start\" and \"tool end\" separately in `ii job do` output (etc).\n","status":"done","priority":2,"type":"task","created_at":"2026-01-27T14:06:23.785913-06:00","updated_at":"2026-01-27T14:20:09.114311-06:00","closed_at":"2026-01-27T14:20:09.114311-06:00"}
{"id":"pwq7fi3y","title":"require test-commands configuration","description":"let's have 'ii job do' (etc) error if job.test-commands is not configured with length>=1; we should stop assuming 'go test ./...'\n","status":"done","priority":2,"type":"task","created_at":"2026-01-27T14:10:13.532615-06:00","updated_at":"2026-01-27T18:48:37.363602-06:00","closed_at":"2026-01-27T18:48:37.363602-06:00","started_at":"2026-01-27T18:35:41.359239-06:00","completed_at":"2026-01-27T18:48:37.363602-06:00"}
{"id":"nk5xnfnz","title":"Clarify wiggum.fish removal","description":"The current change set deletes , which looks unrelated to the \"require test-commands\" task. If the file is still needed for local workflows, move its removal to a separate todo/PR; if it's intentionally deprecated, capture the rationale and any replacement guidance in docs or release notes.\\n\\nPlease verify whether  is still in use and decide on a deprecation/removal plan.","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-27T14:22:48.271032-06:00","updated_at":"2026-01-27T15:47:44.814921-06:00","deleted_at":"2026-01-27T15:47:44.81377-06:00"}
{"id":"4jdr5sqj","title":"crash bug","description":"Error: read dependencies: jj file show: exit status 1: Error: No such path: dependencies.jsonl\n\nUsage:\nii todo ready [flags]\n\nFlags:\n-h, --help help for ready\n--json Output as JSON\n--limit int Maximum number of todos to show (default 20)\n\n> > fixing\n> > fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan receive]:\nmain.runJobDo(0x105242880, {0x14000708110, 0x1, 0x104839bea?})\n/Users/ajm/Work/incrementum/cmd/ii/job_do.go:108 +0x358\ngithub.com/spf13/cobra.(*Command).execute(0x105242880, {0x140007080f0, 0x1, 0x1})\n/Users/ajm/go/pkg/mod/github.com/spf13/cobra@v1.10.2/command.go:1015 +0x7d4\ngithub.com/spf13/cobra.(*Command).ExecuteC(0x105242b60)\n/Users/ajm/go/pkg/mod/github.com/spf13/cobra@v1.10.2/command.go:1148 +0x350\ngithub.com/spf13/cobra.(\\*Command).Execute(...)\n/Users/ajm/go/pkg/mod/github.com/spf13/cobra@v1.10.2/command.go:1071\nmain.main()\n/Users/ajm/Work/incrementum/cmd/ii/main.go:16 +0xc8\n\ngoroutine 16 [chan receive]:\nmain.runJobDo.func2()\n/Users/ajm/Work/incrementum/cmd/ii/job_do.go:87 +0x6c\ncreated by main.runJobDo in goroutine 1\n/Users/ajm/Work/incrementum/cmd/ii/job_do.go:84 +0x284\n","status":"done","priority":0,"type":"bug","created_at":"2026-01-27T15:49:04.71464-06:00","updated_at":"2026-01-27T16:36:35.880497-06:00","closed_at":"2026-01-27T16:36:35.880497-06:00","started_at":"2026-01-27T16:23:45.534717-06:00","completed_at":"2026-01-27T16:36:35.880497-06:00"}
{"id":"p5bo2zlc","title":"do-all","description":"see @wiggum.fish -- I've shelled a 'fix-all' command that loops through todos\n\nwe should promote this into an 'ii job do-all'\n\nit should support todo filtering flags:\n\n- ii job do-all --priority=1 should do p0 and p1 todos (p0s first)\n- ii job do-all --type=bug should fix all bugs of any priority\n- ii job do-all --priority=1 --type=bug should fix all p0 and p1 bugs\n","status":"done","priority":2,"type":"task","created_at":"2026-01-27T15:53:46.267267-06:00","updated_at":"2026-01-27T17:51:09.717301-06:00","closed_at":"2026-01-27T17:51:09.717301-06:00","started_at":"2026-01-27T17:13:50.375859-06:00","completed_at":"2026-01-27T17:51:09.717301-06:00"}
{"id":"yjag6hpg","title":"ii job do should accept multiple todo ids","description":"`ii job do abc def ghi` should do abc, def, and ghi in sequence; it should be equivalent to `for todo in abc def ghi; ii job do $todo; end`\n","status":"done","priority":2,"type":"task","created_at":"2026-01-27T15:54:50.431393-06:00","updated_at":"2026-01-27T17:11:58.958182-06:00","closed_at":"2026-01-27T17:11:58.958182-06:00","started_at":"2026-01-27T17:06:38.38536-06:00","completed_at":"2026-01-27T17:11:58.958182-06:00"}
{"id":"7c2a53yk","title":"it looks like we do code review even when there's no diff?","description":"in an 'ii job do' run, I'm seeing\n\n1. implementation happens, succeeds\n2. tests run, succeed\n3. code review happens, succeeds\n4. implementation happens again, decides to make no changes\n5. [this is bad] we the tests and the code review again, even though there were no changes\n\nwe should do the \"did anything change\" check before testing and code review, and if nothing changed, move directly to full-project review\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-27T16:36:23.204365-06:00","updated_at":"2026-01-27T16:59:08.655178-06:00","closed_at":"2026-01-27T16:59:08.655178-06:00","started_at":"2026-01-27T16:38:49.727625-06:00","completed_at":"2026-01-27T16:59:08.655178-06:00"}
{"id":"flvtgrch","title":"seeing empty commits","description":"using incrementum in a different repo, I'm seeing commits like this:\n\n```\nyxpyrrtp a@monks.co 11 seconds ago git_head() 5700133f\n(empty) Mark text extractor gaps todo as complete - no implementation needed\n```\n\nif we're creating empty commits, I think that implies that something in our `job do` loop is failing -- not sure where exactly this failure mode is. read the code, try to understand what's happening here, and fix it.\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-27T17:32:25.099297-06:00","updated_at":"2026-01-27T18:21:44.662282-06:00","closed_at":"2026-01-27T18:21:44.662282-06:00","started_at":"2026-01-27T17:51:30.031142-06:00","completed_at":"2026-01-27T18:21:44.662282-06:00"}
{"id":"w3foyw4d","title":"swarm test: TestDoRecoversFromJobPanic","description":"Running `go test ./...` fails in `swarm` with:\n\n- Test: `TestDoRecoversFromJobPanic`\n- Error: expected job `job-panic` to be cleared\n- Observed during `go test ./...` run on 2026-01-27\n\nThis appears unrelated to the current job diff-stat changes; please investigate the swarm server test cleanup/teardown path for panic recovery and ensure job state is cleared as expected.","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-27T18:15:10.317749-06:00","updated_at":"2026-01-27T18:35:01.051275-06:00","deleted_at":"2026-01-27T18:35:01.050075-06:00"}
{"id":"7oseowzx","title":"mention jj in prompts","description":"when we talk about \"the working tree\", the agent tries to do git operations. it shouldn't! these prompts should say 'the jujutsu working tree' or something instead.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-27T18:31:19.442635-06:00","updated_at":"2026-01-27T18:34:02.188608-06:00","closed_at":"2026-01-27T18:34:02.188608-06:00","started_at":"2026-01-27T18:31:28.717791-06:00","completed_at":"2026-01-27T18:34:02.188608-06:00"}
{"id":"b5to7u3w","title":"opencode session error","description":"In another project where I'm using incrementum, `ii job do` prints this error and exits 1 right after the implementation opencode implementation completes:\n\n```\nError: opencode session not found (repo=/Users/ajm/Work/document-indexer started=2026-01-27T18:43:4\n8.055252-06:00 cutoff=2026-01-27T18:43:43.055252-06:00 total=141 storage=/Users/ajm/.local/share/op\nencode/storage)\nUsage:\n  ii job do [todo-id...] [flags]\n```\n\nfigure out what's going on here and fix it\n","status":"done","priority":2,"type":"bug","created_at":"2026-01-27T18:55:04.393169-06:00","updated_at":"2026-01-27T19:55:38.437028-06:00","closed_at":"2026-01-27T19:55:38.437028-06:00","started_at":"2026-01-27T18:55:06.656561-06:00","completed_at":"2026-01-27T19:55:38.437028-06:00"}
{"id":"ethzjvdw","title":"fix crash","description":"In another project where i'm using incrementum, it died with this error. It's hard to tell from the logs, but it might have been during an implementation prompt? not sure.\n\nAt minimum improve the error message (what did we invoke? with what arguments? etc?), and, if possible, handle the error. If opencode does something weird, maybe we can `jj restore` to our commit sha from before this particular opencode invocation and then retry? (we don't want to restore the whole change away, if this change was the result of multiple serial opencode invocations; only the one part of the change that got weird)\n\n```\nError: opencode implement failed with exit code -1\nUsage:\n  ii job do [todo-id...] [flags]\n```\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T01:36:06.66693-06:00","updated_at":"2026-01-28T02:01:51.206811-06:00","closed_at":"2026-01-28T02:01:51.206811-06:00","started_at":"2026-01-28T01:36:08.883212-06:00","completed_at":"2026-01-28T02:01:51.206811-06:00"}
{"id":"wnv7e4om","title":"add agent to incrementum.toml config","description":"I should be able to set a default agent in my repo's incrementum.toml, under [job].agent\n\nthe cli flag should override this.\n\nprecdence is something like:\n\n```\nopencode run --agent=$(argv.agent || increment.toml.job.agent || \"\")\n```\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T02:10:51.042854-06:00","updated_at":"2026-01-28T02:20:16.75039-06:00","closed_at":"2026-01-28T02:19:36.190297-06:00","started_at":"2026-01-28T02:10:56.262348-06:00","completed_at":"2026-01-28T02:19:36.190297-06:00"}
{"id":"sx6v5vup","title":"add global config","description":"we should have a global config file in ~/.config/incrementum/config.toml with the same schema as [project]/incrementum.toml\n\nflags should take precedence over project values, which should take precedence over global values\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T02:32:42.059949-06:00","updated_at":"2026-01-28T02:46:33.807941-06:00","closed_at":"2026-01-28T02:46:33.807941-06:00","started_at":"2026-01-28T02:33:22.996079-06:00","completed_at":"2026-01-28T02:46:33.807941-06:00"}
{"id":"j37mvsjn","title":"'ii help templates'","description":"we should have a command 'ii help templates' that outputs:\n\n- each default template\n- the path we look for an override to that template (\"incrementum/whatever.tmpl\")\n- the variables we pass into each template, and their types\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T10:47:06.792956-06:00","updated_at":"2026-01-28T11:37:31.380746-06:00","closed_at":"2026-01-28T11:37:31.380746-06:00","started_at":"2026-01-28T11:20:29.24878-06:00","completed_at":"2026-01-28T11:37:31.380746-06:00"}
{"id":"zjubad6g","title":"configure models per-task","description":"We should be able to (in repo-level or global config) specify models per task,\neg project-review-model, code-review-model, or implementation-model.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T13:05:07.28599-06:00","updated_at":"2026-01-28T13:35:57.612628-06:00","closed_at":"2026-01-28T13:35:57.612628-06:00","started_at":"2026-01-28T13:08:02.340448-06:00","completed_at":"2026-01-28T13:35:57.612628-06:00"}
{"id":"aham6dy6","title":"models per-todo","description":"when creating a todo, I should be able to specify particular models for implementation, commit review, and project review\n\nunset by default, but (if set) takes precedence over project-level settings or global settings\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T13:06:37.950775-06:00","updated_at":"2026-01-28T13:53:02.78418-06:00","closed_at":"2026-01-28T13:53:02.78418-06:00","started_at":"2026-01-28T13:36:02.281903-06:00","completed_at":"2026-01-28T13:53:02.78418-06:00"}
{"id":"wf7n7kyn","title":"'Previous Feedback' test result formatting","description":"under 'Previous Feedback', where we show the results of test commands, we shouldn't use a table, we should use text, eg,\n\n```markdown\n- npm run lint is passing\n- npm run test is failing\n```\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T13:29:00.715657-06:00","updated_at":"2026-01-28T14:18:28.598362-06:00","closed_at":"2026-01-28T14:18:28.598362-06:00","started_at":"2026-01-28T13:53:06.412658-06:00","completed_at":"2026-01-28T14:18:28.598362-06:00"}
{"id":"hf6t46nt","title":"use relative paths in file-read logs","description":"these logs:\n\n```log\nOpencode tool start: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/dropbox-fetcher.ts'\nOpencode tool start: read\nOpencode tool end: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/dropbox-fetcher.ts'\nOpencode tool start: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/ftp-fetcher.ts'\nOpencode tool start: read\nOpencode tool end: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/ftp-fetcher.ts'\nOpencode tool start: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/sharepoint-fetcher.ts'\nOpencode tool start: read\nOpencode tool end: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/sharepoint-fetcher.ts'\nOpencode tool start: read file '/Users/ajm/Work/document-indexer/src/document-fetcher/adapters/skeleton-adapters.test.ts'\nOpencode tool start: read\n```\n\nshould use repo-relative paths (if the file is in the repo, which, in this case, they are); not absolute paths\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T13:34:21.450013-06:00","updated_at":"2026-01-28T14:34:40.472457-06:00","closed_at":"2026-01-28T14:34:40.472457-06:00","started_at":"2026-01-28T14:22:22.463332-06:00","completed_at":"2026-01-28T14:34:40.472457-06:00"}
{"id":"wfpwcr7c","title":"'ii job list' should list the models used","description":"'ii job list' should have columns listing the models used for implementation, review, project-review\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T13:46:44.397247-06:00","updated_at":"2026-01-28T14:49:09.215082-06:00","closed_at":"2026-01-28T14:49:09.215082-06:00","started_at":"2026-01-28T14:34:44.076608-06:00","completed_at":"2026-01-28T14:49:09.215082-06:00"}
{"id":"2u423uo3","title":"add updated column to 'ii todo list'","description":"we should have three time columns in 'ii todo list'\n\n- age (now()-createdAt)\n- updated (now()-updatedAt)\n- duration (completedAt-createdAt)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T14:05:00.161988-06:00","updated_at":"2026-01-28T14:54:34.87493-06:00","closed_at":"2026-01-28T14:54:34.87493-06:00","started_at":"2026-01-28T14:49:12.847284-06:00","completed_at":"2026-01-28T14:54:34.87493-06:00"}
{"id":"icfuymon","title":"commit message prompt fix","description":"the part of the default prompt template in 'ii job do' that talks about writing commit messages should specify that the commit message is for the _entire_ diff in the working tree, not just changes made in this turn. We're seeing a failure mode where when we re-run the implementation prompt in response to code review, it fixes the review and writes a message that only talks about the fixes, which the next review cycle rejects.\n\nuse your judgement about how to accomplish this using no more words than necessary\n","status":"done","priority":0,"type":"task","created_at":"2026-01-28T14:09:59.938777-06:00","updated_at":"2026-01-28T14:22:18.877413-06:00","closed_at":"2026-01-28T14:22:18.877413-06:00","started_at":"2026-01-28T14:18:32.221013-06:00","completed_at":"2026-01-28T14:22:18.877413-06:00"}
{"id":"aum45xmk","title":"clean up template abstractions","description":"reviewQuestionsTemplate should be embedded from the templates directory, and overrideable in project config\n\nreviewInstructionsText should also be embedded from the templates directory, but should _not_ be overrideable in project config (since it's spiritually part of our internal API)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T16:14:24.595077-06:00","updated_at":"2026-01-28T16:30:11.289858-06:00","closed_at":"2026-01-28T16:30:11.289858-06:00","started_at":"2026-01-28T16:14:30.538394-06:00","completed_at":"2026-01-28T16:30:11.289858-06:00"}
{"id":"zt3cqjpi","title":"support config folder or file","description":"for project-level config, we should support both incrementum.toml and .incrementum/config.toml\n\nif both exist, just error\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T16:18:20.427314-06:00","updated_at":"2026-01-28T17:04:45.450082-06:00","closed_at":"2026-01-28T17:04:45.450082-06:00","started_at":"2026-01-28T16:59:12.975167-06:00","completed_at":"2026-01-28T17:04:45.450082-06:00"}
{"id":"gtj6uk6o","title":"disable 'ask' tool in opencode invocations","description":"when we invoke opencode, we don't give stdin to the user, so tools that require user input can't succeed\n\nwe should pass this config into env OPENCODE_CONFIG_CONTENT when we invoke opencode:\n\n```text\n{\"permission\":{\"question\":\"deny\"}}\n```\n","status":"done","priority":0,"type":"task","created_at":"2026-01-28T16:20:47.500933-06:00","updated_at":"2026-01-28T16:49:32.443958-06:00","closed_at":"2026-01-28T16:49:32.443958-06:00","started_at":"2026-01-28T16:38:44.427779-06:00","completed_at":"2026-01-28T16:49:32.443958-06:00"}
{"id":"bq565neh","title":"snapshot jj before invoking opencode","description":"maybe we're already doing this, but:\n\nwhenever we invoke opencode in 'ii job do', we should first do a 'jj debug snapshot' operation\n\nthat operation reads the contents of the working directory into vcs so that they're reflected in commands like 'jj diff' and 'jj status', which the opencode agent might try to run\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T16:38:28.532937-06:00","updated_at":"2026-01-28T17:20:58.171203-06:00","closed_at":"2026-01-28T17:20:58.171203-06:00","started_at":"2026-01-28T17:09:59.301876-06:00","completed_at":"2026-01-28T17:20:58.171203-06:00"}
{"id":"ntq3pgb7","title":"use template empty for diff check","description":"in 'ii job do', when we check if an implementation prompt produced a change, we should use this jj invocation rather than 'diff':\n\n```bash\njj log -r @ -T empty --no-graph\n```\n\nit will output \"true\" (if the current change is empty--no diff) or \"false\" (if it is not empty)\n","status":"done","priority":0,"type":"task","created_at":"2026-01-28T16:43:30.464429-06:00","updated_at":"2026-01-28T16:59:09.263578-06:00","closed_at":"2026-01-28T16:59:09.263578-06:00","started_at":"2026-01-28T16:49:36.158834-06:00","completed_at":"2026-01-28T16:59:09.263578-06:00"}
{"id":"hkuvsprf","title":"remove 'Workspace root' from templates","description":"none of our templates should have a 'Workspace root' line; remove it wherever it appears\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T16:57:57.037719-06:00","updated_at":"2026-01-28T17:29:55.259471-06:00","closed_at":"2026-01-28T17:29:55.259471-06:00","started_at":"2026-01-28T17:21:01.894899-06:00","completed_at":"2026-01-28T17:29:55.259471-06:00"}
{"id":"wiyahhra","title":"capture opencode errors","description":"if opencode exits !0, capture its stderr and add it to the error message\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T18:55:56.453025-06:00","updated_at":"2026-01-28T19:08:08.689231-06:00","closed_at":"2026-01-28T19:08:08.689231-06:00","started_at":"2026-01-28T18:55:59.70263-06:00","completed_at":"2026-01-28T19:08:08.689231-06:00"}
{"id":"k2cc3dmw","title":"abandon reason","description":"in 'ii job do', the 'ABANDANON' review result should require a blurb (like the change request one does) and that blurb should be printed nicely to stdout before ii exits\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T19:34:03.760525-06:00","updated_at":"2026-01-28T19:45:35.719224-06:00","closed_at":"2026-01-28T19:45:35.719224-06:00","started_at":"2026-01-28T19:34:07.031568-06:00","completed_at":"2026-01-28T19:45:35.719224-06:00"}
{"id":"qo25m3bx","title":"fine-grained bash permission","description":"merge this into the config we launch opencode with:\n\n```json\n{\n  \"permission\": {\n    \"bash\": {\n      \"*\": \"allow\",\n      \"jj *\": \"deny\",\n      \"jj diff\": \"allow\",\n      \"jj diff *\": \"allow\",\n      \"jj file\": \"allow\",\n      \"jj file *\": \"allow\",\n      \"jj log\": \"allow\",\n      \"jj log *\": \"allow\",\n      \"jj show\": \"allow\",\n      \"jj show *\": \"allow\"\n    }\n  }\n}\n```\n\nat this point we should probably be using a javascript object that we stringify, rather than inlining the string (maybe we are already doing this idk)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-28T19:40:25.779657-06:00","updated_at":"2026-01-28T19:52:30.066739-06:00","closed_at":"2026-01-28T19:51:19.582979-06:00","started_at":"2026-01-28T19:46:02.803018-06:00","completed_at":"2026-01-28T19:51:19.582979-06:00"}
{"id":"jvjykgc7","title":"implement design todo spec","description":"Implement design todos as specified in specs/design.md","status":"done","priority":2,"type":"task","created_at":"2026-01-29T03:07:20.572802-06:00","updated_at":"2026-01-29T03:53:47.69088-06:00","closed_at":"2026-01-29T03:53:47.69088-06:00","started_at":"2026-01-29T03:21:26.687757-06:00","completed_at":"2026-01-29T03:53:47.69088-06:00"}
{"id":"6dsdedm3","title":"implement habit spec","description":"Implement the habit subsystem as specified in specs/habit.md","status":"done","priority":2,"type":"task","created_at":"2026-01-29T03:07:23.361312-06:00","updated_at":"2026-01-29T11:35:01.754931-06:00","closed_at":"2026-01-29T11:35:01.754931-06:00","started_at":"2026-01-29T11:08:28.447207-06:00","completed_at":"2026-01-29T11:35:01.754931-06:00"}
{"id":"jrjme3jp","title":"add 'waiting' status to todo store","description":"Add a new status value 'waiting' to the todo status enum.\n\nSemantics:\n- Represents todos blocked on external factors (upstream PRs, API availability, etc.)\n- Not included in the ready queue\n- Reason for waiting lives in the description field (unstructured)\n- Visible in 'todo list' output\n- Different from dependency blocking: waiting is for external factors, deps are for internal task ordering\n\nUpdate specs/todo.md with the new status and its semantics.","status":"done","priority":2,"type":"task","created_at":"2026-01-29T03:07:32.406091-06:00","updated_at":"2026-01-29T10:58:37.336496-06:00","closed_at":"2026-01-29T10:58:37.336496-06:00","started_at":"2026-01-29T10:48:45.606882-06:00","completed_at":"2026-01-29T10:58:37.336496-06:00"}
{"id":"6rt62qid","title":"add 'source' field to todo store","description":"Add an optional 'source' string field to todos to track where they came from.\n\nValues:\n- Empty or omitted: user-created todo\n- 'habit:<name>': artifact created by running a habit\n\nThis field enables:\n- Filtering todos by origin (ii todo list --source habit:cleanup)\n- Tracking which habits have produced what work\n- Distinguishing user work from automated improvements\n\nUpdate specs/todo.md with the new field.","status":"done","priority":2,"type":"task","created_at":"2026-01-29T03:07:35.21006-06:00","updated_at":"2026-01-29T11:08:21.934675-06:00","closed_at":"2026-01-29T11:08:21.934675-06:00","started_at":"2026-01-29T10:58:43.939224-06:00","completed_at":"2026-01-29T11:08:21.934675-06:00"}
{"id":"fvy2pvsd","title":"add --habit flag to 'ii job do'","description":"Add habit support to the job do command:\n\n- 'ii job do --habit <name>' runs the named habit from .incrementum/habits/<name>.md\n- 'ii job do --habit' (no name) runs the alphabetically first habit\n\nThe habit workflow differs from regular todos:\n- Uses habit-specific prompt templates (prompt-habit-implementation.tmpl, prompt-habit-review.tmpl)\n- Skips project review stage\n- On ACCEPT: commits and creates an artifact todo with source: habit:<name>\n- On ABANDON: job completes successfully with no artifact (valid outcome for habits)\n- Commit message includes full habit instructions text\n\nUpdate specs/job.md with the new flag and workflow details.","status":"done","priority":2,"type":"task","created_at":"2026-01-29T03:07:38.296281-06:00","updated_at":"2026-01-29T11:59:43.672331-06:00","closed_at":"2026-01-29T11:59:43.672331-06:00","started_at":"2026-01-29T11:35:08.398778-06:00","completed_at":"2026-01-29T11:59:43.672331-06:00"}
{"id":"sftxrf4h","title":"add --habits flag to 'ii job do-all'","description":"Add habit support to the job do-all command:\n\n- 'ii job do-all --habits' runs ready todos first, then round-robins through habits\n- Habits are processed in alphabetical order when the todo queue is empty\n- Without the flag, do-all ignores habits entirely\n\nUpdate specs/job.md with the new flag and behavior.","status":"tombstone","priority":2,"type":"task","created_at":"2026-01-29T03:07:41.126729-06:00","updated_at":"2026-01-29T03:20:53.704177-06:00","deleted_at":"2026-01-29T03:20:53.702849-06:00"}
{"id":"ojuqmwuc","title":"add habits","description":"now that the habit system is in place, take the old evergreen todos in `ii todo show dkyx` and `thpm` and make habits of them\n","status":"done","priority":2,"type":"task","created_at":"2026-01-29T11:33:40.836293-06:00","updated_at":"2026-01-29T12:07:07.230062-06:00","closed_at":"2026-01-29T12:00:47.266972-06:00","started_at":"2026-01-29T11:59:50.337332-06:00","completed_at":"2026-01-29T12:00:47.266972-06:00"}
{"id":"qlbc3ex4","title":"ban git commands","description":"our opencode config that denies and allows bash commands should deny `git *`\n","status":"done","priority":2,"type":"task","created_at":"2026-01-29T11:44:02.810421-06:00","updated_at":"2026-01-29T12:34:10.43895-06:00","closed_at":"2026-01-29T12:34:10.43895-06:00","started_at":"2026-01-29T12:20:40.274324-06:00","completed_at":"2026-01-29T12:34:10.43895-06:00"}
{"id":"xypum7yv","title":"include content in approvals, and include that content in commit messages","description":"in 'ii job do', currently approvals don't require explanatory text but change requests do.\n\nlet's,\n\n1. ask reviewers to include text with approving reviews\n2. pass that text through so it appears in a new section of the commit message\n","status":"done","priority":2,"type":"task","created_at":"2026-01-29T13:03:26.057196-06:00","updated_at":"2026-01-29T13:29:33.176469-06:00","closed_at":"2026-01-29T13:29:33.176469-06:00","started_at":"2026-01-29T13:03:32.159079-06:00","completed_at":"2026-01-29T13:29:33.176469-06:00"}
{"id":"idovacma","title":"implement the job-changes spec","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-29T13:57:52.514553-06:00","updated_at":"2026-01-29T19:46:50.515065-06:00","closed_at":"2026-01-29T19:46:50.515065-06:00","started_at":"2026-01-29T19:43:01.714147-06:00","completed_at":"2026-01-29T19:46:50.515065-06:00"}
{"id":"m2zebjfs","title":"habits showing up in job list","description":"it looks like 'ii job list' (try it in this repo) shows all configured habits as 'implementing'|'active', even when they are not in fact implementing or active. fix this. they should only appear if there is an actual job running the habit.\n","status":"done","priority":1,"type":"bug","created_at":"2026-01-29T14:15:19.025997-06:00","updated_at":"2026-01-29T19:16:56.936034-06:00","closed_at":"2026-01-29T19:16:56.936034-06:00","started_at":"2026-01-29T18:51:11.77498-06:00","completed_at":"2026-01-29T19:16:56.936034-06:00"}
{"id":"552mai2s","title":"glamor can panic","description":"glamor can panic on some markdown inputs; make a SafeRender or something and use it everywhere. I don't have example panicky input handy, so we can't really test this, but let's say that's fine.\n","status":"done","priority":0,"type":"task","created_at":"2026-01-29T14:16:19.138342-06:00","updated_at":"2026-01-29T14:32:44.205581-06:00","closed_at":"2026-01-29T14:32:44.205581-06:00","started_at":"2026-01-29T14:19:50.82093-06:00","completed_at":"2026-01-29T14:32:44.205581-06:00"}
{"id":"joi37psa","title":"let's avoid storing full prompts in our json state file","description":"full prompts make the json state file untenably large; we can reconstruct them anyway from todos I think.\n\nlet's not store them anymore, and also add some code (which we can remove after a while) that deletes them if they are found to exist.\n","status":"done","priority":1,"type":"task","created_at":"2026-01-29T14:17:57.90352-06:00","updated_at":"2026-01-29T19:32:51.194754-06:00","closed_at":"2026-01-29T19:32:51.194754-06:00","started_at":"2026-01-29T19:17:03.573842-06:00","completed_at":"2026-01-29T19:32:51.194754-06:00"}
{"id":"y2ikbs7w","title":"conflict in implementation prompt guidance","description":"i'm seeing implementation runs bite off too much\n\ni think the problem is that we have both text like \"do only the next step\" and also text like \"resolve the todo completely\"\n\nlet's remove the \"resolve the todo completely\" text, and instead say something like \"this change should be complete and atomic; tests should pass, specs should be updated, and the commit message should describe how it advances us towards the todo\"\n","status":"done","priority":0,"type":"task","created_at":"2026-01-29T14:46:58.30665-06:00","updated_at":"2026-01-29T15:55:32.667463-06:00","closed_at":"2026-01-29T15:55:32.667463-06:00","started_at":"2026-01-29T15:46:28.891268-06:00","completed_at":"2026-01-29T15:55:32.667463-06:00"}
{"id":"ovc65g6s","title":"better logs","description":"here are some example logs I copied from stderr during a 'job do' run:\n\n```logs\n  Opencode tool start: apply patch\n  Opencode tool start: apply patch\n  Opencode tool end: apply patch\n  Opencode tool start: bash\n  Opencode tool start: run 'npm run lint'\n  Opencode tool end: run 'npm run lint'\n  Opencode tool start: apply patch\n  Opencode tool start: apply patch\n  Opencode tool end: apply patch\n```\n\n- rm the word 'Opencode'; repetitive and redundant\n- the 'apply patch' log should include the file(s) touched if possible\n- it looks like bash invocations do a bash start and then another start for\n  the actual invocation; we don't need to log the bash start since it's\n  redundant\n- at the top i see two apply patch starts and then one apply patch end. I\n  assume the first one failed? we should emit a fail log if possible\n","status":"done","priority":1,"type":"task","created_at":"2026-01-29T16:24:58.164544-06:00","updated_at":"2026-01-29T19:42:59.93689-06:00","closed_at":"2026-01-29T19:41:59.331128-06:00","started_at":"2026-01-29T19:32:53.009174-06:00","completed_at":"2026-01-29T19:41:59.331128-06:00"}
{"id":"lqn6zkdu","title":"only use the generated part of the commit message in review prompts","description":"our commit messages have a few chunks: the generated commit message, review text, the todo, maybe more\n\nour review prompts have our commit messages injected into them.\n\ninstead of injecting the _entire_ commit message, we should only inject the generated commit message that came from the implementation agent. including previous review text is context poison, and including the todo is redundant.\n","status":"done","priority":2,"type":"task","created_at":"2026-01-29T17:23:59.150105-06:00","updated_at":"2026-01-29T18:36:15.629679-06:00","closed_at":"2026-01-29T18:36:15.629679-06:00","started_at":"2026-01-29T18:19:16.15786-06:00","completed_at":"2026-01-29T18:36:15.629679-06:00"}
{"id":"xaev462a","title":"drop 'swarm'","description":"let's get rid of the 'ii swarm' featureset entirely; i don't use it; I prefer to manually orchestrate 'ii job do'\n\nthis is a lot of stuff to delete (the package, the cli wrapper, some spec content), but that's ok\n","status":"done","priority":2,"type":"task","created_at":"2026-01-29T17:41:54.363204-06:00","updated_at":"2026-01-29T17:58:15.578497-06:00","closed_at":"2026-01-29T17:55:43.331806-06:00","started_at":"2026-01-29T17:44:36.786794-06:00","completed_at":"2026-01-29T17:55:43.331806-06:00"}
{"id":"sgxepy3k","title":"extra newline in opencode response logs","description":"here's some log output:\n\n```\nOpencode tool end: read file 'job/implementing_stage_test.go'\nOpencode response:\n\n      The test is failing because CurrentChangeID is nil in the test\n      setup. Let me check the test and fix it:\nOpencode tool start: edit\nOpencode tool start: edit file 'job/implementing_stage_test.go'\nOpencode tool end: edit file 'job/implementing_stage_test.go'\nOpencode response:\n\n      I need to add CurrentChangeID to all the tests that call\n      runImplementingStage. Let me fix the tests:\nOpencode tool start: edit\nOpencode tool start: edit file 'job/implementing_stage_test.go'\n```\n\nget rid of those blank lines before opencode responses\n","status":"done","priority":2,"type":"task","created_at":"2026-01-29T18:06:29.211803-06:00","updated_at":"2026-01-29T18:51:05.193646-06:00","closed_at":"2026-01-29T18:51:05.193646-06:00","started_at":"2026-01-29T18:36:22.334722-06:00","completed_at":"2026-01-29T18:51:05.193646-06:00"}
{"id":"4dawioy5","title":"add habit management subcommand/package","description":"```bash\nii habit list\nii habit show\nii habit edit (ii habit update)\nii habit create\nii job do --habit=HABIT\nii job do --habit # opens editor to create new habit and then do\n```\n\nii habit should have a similar interface to 'ii todo'\n\nunlike todos, habits are stored as files in the main tree; don't change this\n\nremember to add a spec; perhaps some existing spec content should move into it.\n\nremember the architecture: cmd/ii is thin wrapper around (eg) ./habit\n\nfirst step: spec changes\n\nsecond step: habit package\n\nthird step: cli package\n\nfourth step: clean up\n","status":"done","priority":2,"type":"task","created_at":"2026-01-30T03:03:43.813536-06:00","updated_at":"2026-01-30T03:38:45.149486-06:00","closed_at":"2026-01-30T03:38:45.149486-06:00","started_at":"2026-01-30T03:03:45.501439-06:00","completed_at":"2026-01-30T03:38:45.149486-06:00"}
{"id":"t4quhtdn","title":"habit list improvements","description":"habit list should do a table like the other lists\n\ncolumns should include the frontmatter stuff plus count of jobs sourced from that habit\n\nlike todos, should highlight the unique prefix and habits should be prefix addressable\n\n(some steps here: methods on job model for counting, prefix stuff, table, etc)\n","status":"done","priority":2,"type":"task","created_at":"2026-01-30T03:46:13.627375-06:00","updated_at":"2026-01-30T04:01:41.593698-06:00","closed_at":"2026-01-30T04:01:41.593698-06:00","started_at":"2026-01-30T03:46:15.339013-06:00","completed_at":"2026-01-30T04:01:41.593698-06:00"}
{"id":"hc5mbnur","title":"integrator","description":"","status":"open","priority":2,"type":"design","created_at":"2026-01-30T03:47:34.521608-06:00","updated_at":"2026-01-30T03:47:34.521608-06:00"}
{"id":"pcyuwlwc","title":"Refactor normalizeRunOptions to create jj.Client lazily once","description":"\nThe normalizeRunOptions function was creating 9 separate jj.Client\ninstances when defaulting various function options (CurrentCommitID,\nCurrentChangeID, DiffStat, etc.). Although jj.New() is cheap (just\nreturns an empty struct), creating multiple instances was unnecessarily\nverbose and inconsistent with how we handle similar dependencies\nelsewhere.\n\nThis change introduces a lazy getter pattern that creates at most one\njj.Client instance, only when at least one of the jj-related options\nneeds defaulting. This makes the code cleaner and more consistent,\nwithout changing any behavior - tests that provide mocks for individual\noptions continue to work exactly as before.","status":"done","priority":2,"type":"task","created_at":"2026-01-30T13:51:16.311915-06:00","updated_at":"2026-01-30T13:51:16.521547-06:00","closed_at":"2026-01-30T13:51:16.416498-06:00","started_at":"2026-01-30T13:51:16.311915-06:00","completed_at":"2026-01-30T13:51:16.416498-06:00","source":"habit:cleanup"}
{"id":"bgluzhxz","title":"job do --habit should accept prefixes","description":"","status":"done","priority":2,"type":"task","created_at":"2026-01-31T01:29:47.277274-06:00","updated_at":"2026-01-31T05:43:28.749719-06:00","closed_at":"2026-01-31T05:43:28.749719-06:00","started_at":"2026-01-31T05:33:05.85531-06:00","completed_at":"2026-01-31T05:43:28.749719-06:00"}
{"id":"i7j5g246","title":"Add paths.ResolveWithDefault to consolidate override-or-fallback pattern","description":"\nMultiple packages (job, opencode, workspace) had duplicate code for resolving\nconfigurable paths: \"if override is provided, use it; otherwise call a default\nfunction\". This pattern was repeated 6 times with identical logic:\n\n  stateDir := opts.StateDir\n  if stateDir == \"\" {\n      var err error\n      stateDir, err = paths.DefaultStateDir()\n      if err != nil {\n          return nil, err\n      }\n  }\n\nThe new ResolveWithDefault helper in internal/paths encapsulates this pattern:\n\n  stateDir, err := paths.ResolveWithDefault(opts.StateDir, paths.DefaultStateDir)\n\nThis reduces boilerplate, makes the intent clearer, and ensures consistent\nbehavior across all callers. The helper is generic enough to work with any\ndefault function that returns (string, error).\n\nUpdated callers:\n- job/manager.go: resolveStateDir\n- job/events.go: eventLogPath\n- opencode/store.go: OpenWithOptions (3 paths)\n- workspace/pool.go: OpenWithOptions (2 paths)","status":"done","priority":2,"type":"task","created_at":"2026-01-31T01:36:35.919622-06:00","updated_at":"2026-01-31T01:36:36.151174-06:00","closed_at":"2026-01-31T01:36:36.033133-06:00","started_at":"2026-01-31T01:36:35.919622-06:00","completed_at":"2026-01-31T01:36:36.033133-06:00","source":"habit:cleanup"}
{"id":"hzmrhk2g","title":"should find workspace in working directory","description":"```\n> cd (ii workspace acquire --purpose=test)\n> ii workspace release\nError: repo source path not found\nUsage:\n  ii workspace release [name] [flags]\n\nFlags:\n  -h, --help   help for release\n\nexit status 1\n```\n","status":"open","priority":2,"type":"bug","created_at":"2026-01-31T05:43:32.505075-06:00","updated_at":"2026-01-31T05:43:32.505075-06:00"}
