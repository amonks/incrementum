# setup repo
mkdir repo
cd repo
exec jj git init

# create todo
stdin input.txt
exec $II todo create 'Session todo'

exec $II todo list --json
todoid stdout 'Session todo' TODO_ID

# start session
exec $II session start $TODO_ID
envset WORKSPACE_PATH stdout
exists $WORKSPACE_PATH

# list sessions
exec $II session list --json
stdout ${TODO_ID@R}
stdout '"status": "active"'
stdout '"workspace_name": "ws-[0-9]{3}"'

# mark done
exec $II session done $TODO_ID
stdout 'marked completed'

# default list excludes completed
exec $II session list --json
! stdout ${TODO_ID@R}

# list completed
exec $II session list --status completed --json
stdout ${TODO_ID@R}
stdout '"status": "completed"'

# list all
exec $II session list --all --json
stdout ${TODO_ID@R}

-- repo/input.txt --
y
